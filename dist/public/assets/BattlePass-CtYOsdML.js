import{j as e}from"./ui-vendor-BpIggZZ9.js";import{u as L}from"./react-vendor-C7VPsBAG.js";import{u as k,P as F,b as y,N as o,C as n,B as x,a0 as u,p as t,f as T,g as q,i as h,ai as p,n as b,a1 as X,F as S,a3 as B,$ as E}from"./index-Bshoxa3b.js";import{P as U}from"./progress-BQnuNZzz.js";import{T as A}from"./trophy-4C1s-oG7.js";import{C as c}from"./crown-DnGdiNOO.js";import{G as N}from"./gift-CIPErmUR.js";import{Z as D}from"./zap-CuepkoNH.js";import"./utils-vendor-BUCX3MvZ.js";function J(){const[,g]=L(),{isAuthenticated:i,isLoading:f}=k(),{toast:l}=F(),{data:a,isLoading:v}=y({queryKey:["/api/battle-pass/my-progress"],queryFn:async()=>{const s=await fetch("/api/battle-pass/my-progress",{credentials:"include"});if(!s.ok)throw new Error("Failed to fetch progress");return s.json()},enabled:i}),{data:m,isLoading:w}=y({queryKey:["/api/battle-pass/rewards"],queryFn:async()=>{const s=await fetch("/api/battle-pass/rewards",{credentials:"include"});if(!s.ok)throw new Error("Failed to fetch rewards");return s.json()},enabled:i}),P=async()=>{if(!i){g("/login?returnTo=/battle-pass");return}try{const s=await fetch("/api/battle-pass/upgrade",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"include"});if(!s.ok){const r=await s.json();throw new Error(r.message||"Failed to upgrade")}l({title:"Battle Pass Upgraded!",description:"You now have access to all premium rewards"})}catch(s){l({title:"Upgrade Failed",description:s.message,variant:"destructive"})}},C=async s=>{try{const r=await fetch("/api/battle-pass/claim-reward",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"include",body:JSON.stringify({tier:s})});if(!r.ok){const d=await r.json();throw new Error(d.message||"Failed to claim reward")}l({title:"Reward Claimed!",description:"Check your inventory"})}catch(r){l({title:"Claim Failed",description:r.message,variant:"destructive"})}},j=s=>{switch(s){case"coins":return e.jsx(E,{className:"w-5 h-5 text-amber-500"});case"premium_chapter":return e.jsx(B,{className:"w-5 h-5 text-purple-500"});case"cosmetic":return e.jsx(c,{className:"w-5 h-5 text-pink-500"});default:return e.jsx(N,{className:"w-5 h-5 text-blue-500"})}};if(!i)return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[e.jsx(o,{}),e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-20",children:e.jsxs(n,{className:"bg-gray-900/50 border-gray-800 text-center p-16",children:[e.jsx(A,{className:"w-16 h-16 mx-auto mb-4 text-gray-600"}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Login Required"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Sign in to access the Battle Pass"}),e.jsx(x,{onClick:()=>g("/login?returnTo=/battle-pass"),className:"bg-gradient-to-r from-primary to-accent",children:"Login"})]})})]});if(f||v||w)return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[e.jsx(o,{}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-20",children:[e.jsx(u,{className:"h-64 bg-gray-800 mb-6"}),e.jsx(u,{className:"h-96 bg-gray-800"})]})]});const R=a?a.xp/a.xpForNextLevel*100:0;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[e.jsx(o,{}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-16",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Battle Pass"}),e.jsx("p",{className:"text-gray-400",children:a?.seasonName||"Current Season"})]}),!a?.isPremium&&e.jsxs(x,{onClick:P,className:"bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white shadow-lg",size:"lg",children:[e.jsx(c,{className:"w-5 h-5 mr-2"}),"Upgrade to Premium"]})]}),a?.isPremium&&e.jsxs(t,{className:"bg-amber-500/20 text-amber-500 border-amber-500/30 mb-4",children:[e.jsx(c,{className:"w-4 h-4 mr-1"}),"Premium Pass Active"]})]}),e.jsxs(n,{className:"bg-gray-900/50 border-gray-800 mb-8",children:[e.jsx(T,{children:e.jsxs(q,{className:"text-white flex items-center justify-between",children:[e.jsxs("span",{children:["Level ",a?.level||1]}),e.jsxs("span",{className:"text-sm font-normal text-gray-400",children:["Season ends: ",a?.seasonEnd?new Date(a.seasonEnd).toLocaleDateString():"TBD"]})]})}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"XP Progress"}),e.jsxs("span",{className:"text-white font-semibold",children:[a?.xp||0," / ",a?.xpForNextLevel||100]})]}),e.jsx(U,{value:R,className:"h-3 bg-gray-800"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center pt-4 border-t border-gray-800",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:a?.level||1}),e.jsx("p",{className:"text-sm text-gray-400",children:"Current Level"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:m?.filter(s=>s.claimed).length||0}),e.jsx("p",{className:"text-sm text-gray-400",children:"Rewards Claimed"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-amber-500",children:m?.length||0}),e.jsx("p",{className:"text-sm text-gray-400",children:"Total Rewards"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Rewards"}),m?.map(s=>{const r=a&&a.level>=s.level,d=r&&!s.claimed;return e.jsx(n,{className:p("bg-gray-900/50 border-gray-800 transition-all duration-300",r&&"border-primary/30"),children:e.jsx(h,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6 items-center",children:[e.jsx("div",{className:"md:col-span-2 text-center",children:e.jsx("div",{className:p("inline-flex items-center justify-center w-16 h-16 rounded-full border-2",r?"border-primary bg-primary/10":"border-gray-700 bg-gray-800"),children:e.jsx("span",{className:"text-2xl font-bold text-white",children:s.level})})}),e.jsxs("div",{className:"md:col-span-4",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase mb-2",children:"Free Reward"}),e.jsxs("div",{className:"flex items-center gap-3",children:[j(s.freeReward.type),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:s.freeReward.name}),e.jsxs("p",{className:"text-sm text-gray-400",children:["x",s.freeReward.amount]})]})]})]}),e.jsxs("div",{className:"md:col-span-4",children:[e.jsxs("p",{className:"text-xs text-amber-500 uppercase mb-2 flex items-center gap-1",children:[e.jsx(c,{className:"w-3 h-3"}),"Premium Reward"]}),e.jsx("div",{className:p("flex items-center gap-3",!a?.isPremium&&"opacity-40"),children:a?.isPremium?e.jsxs(e.Fragment,{children:[j(s.premiumReward.type),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:s.premiumReward.name}),e.jsxs("p",{className:"text-sm text-gray-400",children:["x",s.premiumReward.amount]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-5 h-5 text-gray-600"}),e.jsx("p",{className:"text-gray-500",children:"Premium Required"})]})})]}),e.jsx("div",{className:"md:col-span-2 text-right",children:s.claimed?e.jsxs(t,{className:"bg-green-500/20 text-green-500 border-green-500/30",children:[e.jsx(X,{className:"w-4 h-4 mr-1"}),"Claimed"]}):d?e.jsxs(x,{onClick:()=>C(s.level),size:"sm",className:"bg-primary hover:bg-primary/90",children:[e.jsx(N,{className:"w-4 h-4 mr-1"}),"Claim"]}):r?e.jsx(t,{variant:"secondary",children:"Ready"}):e.jsxs(t,{variant:"secondary",className:"bg-gray-800 text-gray-500",children:[e.jsx(b,{className:"w-3 h-3 mr-1"}),"Locked"]})})]})})},s.level)})]}),e.jsx(n,{className:"bg-gradient-to-r from-primary/10 to-accent/10 border-primary/30 mt-8",children:e.jsxs(h,{className:"p-6 text-center",children:[e.jsx(D,{className:"w-12 h-12 mx-auto mb-4 text-primary"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Earn XP to Level Up!"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Read chapters, complete achievements, and engage with the community to earn XP"}),e.jsxs("div",{className:"flex gap-4 justify-center flex-wrap",children:[e.jsx(t,{variant:"outline",className:"border-primary/30 text-primary",children:"+50 XP per chapter read"}),e.jsx(t,{variant:"outline",className:"border-primary/30 text-primary",children:"+100 XP per achievement"}),e.jsx(t,{variant:"outline",className:"border-primary/30 text-primary",children:"+25 XP per comment"})]})]})})]}),e.jsx(S,{})]})}export{J as default};
