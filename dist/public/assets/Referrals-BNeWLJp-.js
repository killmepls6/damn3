import{j as e}from"./ui-vendor-BpIggZZ9.js";import{u as P,b as t}from"./react-vendor-C7VPsBAG.js";import{c as D,u as $,P as I,N as u,a0 as x,C as i,i as l,a7 as U,f as h,g,I as b,B as N,a1 as Y,p as B,F as H}from"./index-Bshoxa3b.js";import{U as p}from"./users-q6XJjClA.js";import{G as O}from"./gift-CIPErmUR.js";import"./utils-vendor-BUCX3MvZ.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=D("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);function W(){const[,w]=P(),{isAuthenticated:o,isLoading:v}=$(),{toast:c}=I(),[s,C]=t.useState(null),[n,R]=t.useState([]),[k,S]=t.useState(!0),[E,y]=t.useState(!1),[d,f]=t.useState("");t.useEffect(()=>{o&&j()},[o]);const j=async()=>{try{const[r,a]=await Promise.all([fetch("/api/referrals/my-code",{credentials:"include"}),fetch("/api/referrals/my-referrals",{credentials:"include"})]);if(r.ok){const m=await r.json();C(m)}if(a.ok){const m=await a.json();R(m)}}catch{}finally{S(!1)}},L=()=>{if(s){const r=`${window.location.origin}/signup?ref=${s.code}`;navigator.clipboard.writeText(r),y(!0),c({title:"Copied!",description:"Referral link copied to clipboard"}),setTimeout(()=>y(!1),2e3)}},T=async()=>{if(!d.trim()){c({title:"Error",description:"Please enter a referral code",variant:"destructive"});return}try{const r=await fetch("/api/referrals/apply",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"include",body:JSON.stringify({code:d})}),a=await r.json();if(!r.ok)throw new Error(a.message||"Failed to apply code");c({title:"Success!",description:`You received ${a.coinsEarned} coins!`}),f(""),j()}catch(r){c({title:"Error",description:r.message,variant:"destructive"})}};if(v||k)return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[e.jsx(u,{}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-20",children:[e.jsx(x,{className:"h-12 w-96 mb-6 bg-gray-800"}),e.jsx(x,{className:"h-64 mb-6 bg-gray-800"}),e.jsx(x,{className:"h-96 bg-gray-800"})]})]});if(!o)return w("/login?returnTo=/referrals"),null;const A=n.reduce((r,a)=>r+a.rewardAmount,0),F=s?`${window.location.origin}/signup?ref=${s.code}`:"";return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[e.jsx(u,{}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-16",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-primary/10 border border-primary/20 rounded-full mb-6",children:[e.jsx(p,{className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"text-sm font-semibold text-primary",children:"Referral Program"})]}),e.jsx("h1",{className:"text-4xl sm:text-6xl font-bold text-white mb-4",children:"Invite Friends, Earn Coins"}),e.jsx("p",{className:"text-gray-400 text-lg max-w-2xl mx-auto",children:"Share your referral link and both you and your friends get bonus coins!"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(i,{className:"bg-gray-900/50 border-gray-800",children:e.jsxs(l,{className:"p-6 text-center",children:[e.jsx(p,{className:"w-12 h-12 mx-auto mb-3 text-primary"}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:n.length}),e.jsx("p",{className:"text-sm text-gray-400",children:"Friends Referred"})]})}),e.jsx(i,{className:"bg-gray-900/50 border-gray-800",children:e.jsxs(l,{className:"p-6 text-center",children:[e.jsx(O,{className:"w-12 h-12 mx-auto mb-3 text-amber-500"}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:A.toLocaleString()}),e.jsx("p",{className:"text-sm text-gray-400",children:"Coins Earned"})]})}),e.jsx(i,{className:"bg-gray-900/50 border-gray-800",children:e.jsxs(l,{className:"p-6 text-center",children:[e.jsx(U,{className:"w-12 h-12 mx-auto mb-3 text-green-500"}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:s?.coinRewardReferrer||0}),e.jsx("p",{className:"text-sm text-gray-400",children:"Coins Per Referral"})]})})]}),e.jsxs(i,{className:"bg-gradient-to-br from-primary/20 to-accent/20 border-primary/40 mb-8",children:[e.jsx(h,{children:e.jsx(g,{className:"text-white text-2xl",children:"Your Referral Link"})}),e.jsxs(l,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx(b,{value:F,readOnly:!0,className:"bg-gray-900 border-gray-700 text-white font-mono text-sm"}),e.jsx(N,{onClick:L,className:"bg-primary hover:bg-primary/90 shrink-0",children:E?e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Copy"]})})]}),e.jsx("div",{className:"bg-primary/10 border border-primary/20 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-gray-300",children:[e.jsx("strong",{className:"text-primary",children:"Reward:"})," You get"," ",e.jsxs("span",{className:"text-white font-semibold",children:[s?.coinRewardReferrer||0," coins"]})," ","and your friend gets"," ",e.jsxs("span",{className:"text-white font-semibold",children:[s?.coinRewardReferred||0," coins"]})]})})]})]}),e.jsxs(i,{className:"bg-gray-900/50 border-gray-800 mb-8",children:[e.jsx(h,{children:e.jsx(g,{className:"text-white",children:"Have a Referral Code?"})}),e.jsx(l,{className:"space-y-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(b,{placeholder:"Enter referral code",value:d,onChange:r=>f(r.target.value),className:"bg-gray-800 border-gray-700 text-white"}),e.jsx(N,{onClick:T,className:"bg-gradient-to-r from-primary to-accent hover:from-primary/90 hover:to-accent/90",children:"Apply Code"})]})})]}),e.jsxs(i,{className:"bg-gray-900/50 border-gray-800",children:[e.jsx(h,{children:e.jsx(g,{className:"text-white",children:"Your Referrals"})}),e.jsx(l,{children:n.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(p,{className:"w-16 h-16 mx-auto mb-4 text-gray-600"}),e.jsx("p",{className:"text-gray-400",children:"No referrals yet. Start inviting friends!"})]}):e.jsx("div",{className:"space-y-3",children:n.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-800/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:r.referredUsername}),e.jsx("p",{className:"text-sm text-gray-400",children:new Date(r.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(B,{className:r.status==="completed"?"bg-green-500/20 text-green-500 border-green-500/30":"bg-yellow-500/20 text-yellow-500 border-yellow-500/30",children:r.status}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["+",r.rewardAmount," coins"]})]})]},r.id))})})]})]}),e.jsx(H,{})]})}export{W as default};
