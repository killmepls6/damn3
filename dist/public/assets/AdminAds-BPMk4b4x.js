import{j as e}from"./ui-vendor-BpIggZZ9.js";import{b as g,u as Ts}from"./react-vendor-C7VPsBAG.js";import{c as ie,ai as ae,B as j,aa as Ue,L as as,l as rs,C as F,f as R,g as I,p as A,i as E,aj as Le,a7 as Ae,h as z,P as ls,ah as is,b as qe,d as Q,m as i,I as y,S as X,T as Oe,u as Fs,a8 as Es,K as Me,ag as Ps,a9 as Us,Y as be}from"./index-Bshoxa3b.js";import{S as _,a as W,b as Y,c as Z,d as x}from"./select-DT_5i3rD.js";import{D as ye,a as we,b as ke,c as Ce,d as De,e as Se}from"./dialog-B4soTW2z.js";import{A as Je,a as ze,b as Ke,c as He,d as Qe,e as Xe,f as _e,g as We}from"./alert-dialog-ckVHmtNn.js";import{C as M}from"./checkbox-CKseajx-.js";import{T as ns,a as cs,b as re,c as le}from"./tabs-72BErqnU.js";import{I as ds}from"./image-DlU6CFoZ.js";import{E as je}from"./eye-QF1-RHmE.js";import{M as me}from"./monitor-CG5dKqcR.js";import{L as Ls,B as Os,D as Rs,C as Is,a as Bs,b as qs,c as $s,d as Vs,e as Gs,A as Ms,p as Js,f as zs,g as Ks,i as Hs}from"./chart-vendor-BWHaG5wj.js";import{T as os}from"./trending-down-CiPk0oR1.js";import{C as ms}from"./chart-column-DGETuS3s.js";import{P as Re}from"./plus-CIXQeA2Y.js";import{A as Qs}from"./AdIntensityControl-CpQnfzYC.js";import{A as Ye}from"./activity-r2qUXDVk.js";import{S as Xs}from"./square-check-big-DgO1Q1Lh.js";import{D as Ze}from"./download-D6kAy5d3.js";import{C as ge}from"./calendar-ByILsbL3.js";import{G as _s}from"./globe-WU3sxzli.js";import{U as Ws}from"./users-q6XJjClA.js";import{D as Pe}from"./dollar-sign-c3-1CJgR.js";import{S as Ys}from"./square-pen-C7u-hRzu.js";import{F as es}from"./file-text-CPLU9rer.js";import"./utils-vendor-BUCX3MvZ.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=ie("FlaskConical",[["path",{d:"M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2",key:"pzvekw"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M7 16h10",key:"wp8him"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=ie("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=ie("MousePointerClick",[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=ie("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=ie("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=ie("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=ie("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=ie("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);async function at(){const o=await fetch("/api/csrf-token",{credentials:"include"});if(!o.ok)throw new Error("Failed to fetch CSRF token");return(await o.json()).csrfToken}function Be({value:o,onChange:f,onFileChange:C,disabled:d=!1,className:w,accept:L="image/jpeg,image/jpg,image/png,image/webp,image/gif",maxSize:v=10,uploadEndpoint:N="/api/admin/upload-ad-image"}){const[u,O]=g.useState(!1),[B,q]=g.useState(o),[G,V]=g.useState(!1),[K,k]=g.useState(null),T=g.useRef(null);g.useEffect(()=>{q(o)},[o]);const ne=p=>{p.preventDefault(),d||O(!0)},H=p=>{p.preventDefault(),O(!1)},se=p=>{const t=L.split(",").map(n=>n.trim());if(!t.includes(p.type))return`Invalid file type. Accepted: ${t.join(", ")}`;const l=v*1024*1024;return p.size>l?`File size must be less than ${v}MB`:null},m=async p=>{V(!0),k(null);try{const t=await at(),l=new FormData;l.append("image",p);const n=await fetch(N,{method:"POST",headers:{"X-CSRF-Token":t},credentials:"include",body:l});if(!n.ok){const P=await n.json();throw new Error(P.message||"Upload failed")}const J=await n.json();f(J.url),q(J.url),C&&C(p)}catch(t){const l=t instanceof Error?t.message:"Failed to upload image";k(l)}finally{V(!1)}},b=async p=>{if(p.preventDefault(),O(!1),d)return;const t=p.dataTransfer.files;if(t.length===0)return;const l=t[0],n=se(l);if(n){k(n);return}await m(l)},D=async p=>{const t=p.target.files;if(!t||t.length===0)return;const l=t[0],n=se(l);if(n){k(n);return}await m(l)},U=()=>{q(void 0),f(""),C&&C(null),T.current&&(T.current.value=""),k(null)};return e.jsxs("div",{className:ae("space-y-2",w),children:[B?e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:B,alt:"Upload preview",className:"w-full h-48 object-cover rounded-lg border-2 border-border"}),e.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center",children:e.jsxs(j,{type:"button",variant:"destructive",size:"sm",onClick:U,disabled:d||G,children:[e.jsx(Ue,{className:"w-4 h-4 mr-2"}),"Remove"]})})]}):e.jsxs("div",{onDragOver:ne,onDragLeave:H,onDrop:b,className:ae("border-2 border-dashed rounded-lg p-8 text-center transition-colors cursor-pointer",u&&!d?"border-primary bg-primary/10":"border-border hover:border-primary/50",d&&"opacity-50 cursor-not-allowed"),onClick:()=>!d&&!G&&T.current?.click(),children:[e.jsx("input",{ref:T,type:"file",accept:L,onChange:D,className:"hidden",disabled:d||G}),G?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(as,{className:"w-12 h-12 text-primary animate-spin"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Uploading..."})]}):e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[u?e.jsx(rs,{className:"w-12 h-12 text-primary"}):e.jsx(ds,{className:"w-12 h-12 text-muted-foreground"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:u?"Drop image here":"Click to upload or drag and drop"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["PNG, JPG, WebP, GIF (max ",v,"MB)"]})]})]})]}),K&&e.jsx("p",{className:"text-sm text-destructive",children:K})]})}function ts({title:o,description:f,imageUrl:C,linkUrl:d,type:w,placement:L,className:v}){const[N,u]=g.useState("desktop"),O={mobile:"max-w-[375px]",tablet:"max-w-[768px]",desktop:"max-w-full"},B=()=>{switch(w){case"banner":return e.jsx("div",{className:"w-full bg-gradient-to-r from-purple-900/20 via-pink-900/20 to-purple-900/20 rounded-lg overflow-hidden border-2 border-purple-500/30",children:C?e.jsxs("div",{className:"relative group cursor-pointer",children:[e.jsx("img",{src:C,alt:o,className:"w-full h-32 md:h-40 object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsxs("div",{className:"absolute bottom-3 left-3 right-3",children:[e.jsx("h4",{className:"font-bold text-white text-sm md:text-base truncate",children:o||"Ad Title"}),f&&e.jsx("p",{className:"text-xs text-white/80 truncate",children:f})]})})]}):e.jsx("div",{className:"h-32 md:h-40 flex items-center justify-center bg-muted/50",children:e.jsx("p",{className:"text-muted-foreground text-sm",children:"Banner Ad Preview"})})});case"sidebar":return e.jsxs("div",{className:"w-full max-w-xs bg-gradient-to-br from-purple-900/10 to-pink-900/10 rounded-lg overflow-hidden border border-purple-500/30",children:[C?e.jsx("img",{src:C,alt:o,className:"w-full h-64 object-cover"}):e.jsx("div",{className:"h-64 flex items-center justify-center bg-muted/50",children:e.jsx("p",{className:"text-muted-foreground text-sm",children:"Sidebar Ad"})}),e.jsxs("div",{className:"p-3 space-y-1",children:[e.jsx("h4",{className:"font-semibold text-sm text-foreground truncate",children:o||"Ad Title"}),f&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:f}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-purple-400 hover:text-purple-300 transition-colors",children:[e.jsx(Le,{className:"w-3 h-3"}),e.jsx("span",{children:"Learn More"})]})]})]});case"popup":return e.jsx("div",{className:"relative max-w-md mx-auto",children:e.jsxs("div",{className:"bg-gradient-to-br from-purple-950 to-pink-950 rounded-xl overflow-hidden border-2 border-purple-500/50 shadow-2xl shadow-purple-500/20",children:[C?e.jsx("img",{src:C,alt:o,className:"w-full h-48 object-cover"}):e.jsx("div",{className:"h-48 flex items-center justify-center bg-muted/50",children:e.jsx("p",{className:"text-muted-foreground text-sm",children:"Popup Ad"})}),e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsx("h3",{className:"font-bold text-lg text-white",children:o||"Ad Title"}),f&&e.jsx("p",{className:"text-sm text-gray-300",children:f}),e.jsx("button",{className:"w-full px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white rounded-lg font-medium transition-all transform hover:scale-105",children:"Learn More"})]})]})});case"inline":return e.jsx("div",{className:"w-full bg-gradient-to-r from-purple-900/5 via-transparent to-pink-900/5 rounded-lg overflow-hidden border border-purple-500/20",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-3 p-3",children:[C?e.jsx("img",{src:C,alt:o,className:"w-full md:w-32 h-24 md:h-20 object-cover rounded"}):e.jsx("div",{className:"w-full md:w-32 h-24 md:h-20 flex items-center justify-center bg-muted/50 rounded",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:"Inline"})}),e.jsxs("div",{className:"flex-1 flex flex-col justify-center",children:[e.jsx(A,{className:"w-fit mb-1 bg-purple-600/20 text-purple-300 border-purple-500/30",children:"Sponsored"}),e.jsx("h4",{className:"font-semibold text-sm text-foreground",children:o||"Ad Title"}),f&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:f})]})]})});default:return e.jsx("div",{className:"w-full h-32 bg-muted/50 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Select an ad type to preview"})})}};return e.jsxs(F,{className:ae("bg-card/50 backdrop-blur border-purple-500/20",v),children:[e.jsxs(R,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"w-4 h-4 text-purple-400"}),e.jsx(I,{className:"text-base",children:"Live Preview"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(A,{variant:"outline",className:"text-xs border-purple-500/30",children:w||"No Type"}),e.jsx(A,{variant:"outline",className:"text-xs border-pink-500/30",children:L||"No Placement"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-3 pt-3 border-t border-border/50",children:[e.jsx("span",{className:"text-xs text-muted-foreground mr-2",children:"Device:"}),e.jsxs(j,{variant:N==="mobile"?"default":"outline",size:"sm",onClick:()=>u("mobile"),className:ae("h-8 gap-1.5",N==="mobile"&&"bg-purple-600 hover:bg-purple-700"),children:[e.jsx(xs,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-xs",children:"Mobile"})]}),e.jsxs(j,{variant:N==="tablet"?"default":"outline",size:"sm",onClick:()=>u("tablet"),className:ae("h-8 gap-1.5",N==="tablet"&&"bg-purple-600 hover:bg-purple-700"),children:[e.jsx(tt,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-xs",children:"Tablet"})]}),e.jsxs(j,{variant:N==="desktop"?"default":"outline",size:"sm",onClick:()=>u("desktop"),className:ae("h-8 gap-1.5",N==="desktop"&&"bg-purple-600 hover:bg-purple-700"),children:[e.jsx(me,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-xs",children:"Desktop"})]}),e.jsxs(A,{variant:"secondary",className:"ml-auto text-xs",children:[N==="mobile"&&"375px",N==="tablet"&&"768px",N==="desktop"&&"Full Width"]})]})]}),e.jsxs(E,{className:"space-y-3",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:ae("w-full transition-all duration-300 ease-in-out",O[N]),children:e.jsx("div",{className:"p-4 bg-background/50 rounded-lg border border-border",children:e.jsx("div",{className:ae("transition-all duration-300",N==="mobile"&&"scale-95",N==="tablet"&&"scale-98"),children:B()})})})}),!C&&e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Upload an image to see the full preview"}),d&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(Le,{className:"w-3 h-3"}),e.jsxs("span",{className:"truncate",children:["Links to: ",d]})]})]})]})}Is.register(Bs,qs,$s,Vs,Gs,Ms,Js,zs,Ks,Hs);function rt({ads:o}){const[f,C]=g.useState("7d"),[d,w]=g.useState("all"),[L,v]=g.useState(!0),[N,u]=g.useState(null),[O,B]=g.useState({totalImpressions:0,totalClicks:0,averageCTR:0}),[q,G]=g.useState([]),[V,K]=g.useState([]),k=n=>{const J=new Date().toISOString().split("T")[0],P=new Date;switch(n){case"7d":P.setDate(P.getDate()-7);break;case"30d":P.setDate(P.getDate()-30);break;case"90d":P.setDate(P.getDate()-90);break;default:P.setDate(P.getDate()-7)}return{startDate:P.toISOString().split("T")[0],endDate:J}},T=async()=>{v(!0),u(null);try{const{startDate:n,endDate:J}=k(f),P=new URLSearchParams({startDate:n,endDate:J}),[oe,xe,fe]=await Promise.all([fetch(`/api/ads/analytics/overview?${P}`),fetch(`/api/ads/analytics/performance-history?${P}`),fetch(`/api/ads/analytics/top-performers?${P}&limit=5`)]);if(!oe.ok||!xe.ok||!fe.ok)throw new Error("Failed to fetch analytics data");const[he,ve,Ne]=await Promise.all([oe.json(),xe.json(),fe.json()]);B(he),G(ve),K(Ne)}catch(n){u(n instanceof Error?n.message:"Failed to load analytics")}finally{v(!1)}};g.useEffect(()=>{T()},[f]);const ne=n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric"}),H=q.map(n=>ne(n.date)),se=q.map(n=>n.impressions),m=q.map(n=>n.clicks),b=q.map(n=>n.ctr),D={labels:H,datasets:[{label:"CTR (%)",data:b,borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",fill:!0,tension:.4}]},U={labels:H,datasets:[{label:"Impressions",data:se,borderColor:"rgb(236, 72, 153)",backgroundColor:"rgba(236, 72, 153, 0.5)",yAxisID:"y"},{label:"Clicks",data:m,borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.5)",yAxisID:"y1"}]},p={labels:["Banner","Sidebar","Popup","Inline"],datasets:[{data:[o.filter(n=>n.type==="banner").length,o.filter(n=>n.type==="sidebar").length,o.filter(n=>n.type==="popup").length,o.filter(n=>n.type==="inline").length],backgroundColor:["rgba(168, 85, 247, 0.8)","rgba(236, 72, 153, 0.8)","rgba(139, 92, 246, 0.8)","rgba(244, 114, 182, 0.8)"],borderColor:["rgb(168, 85, 247)","rgb(236, 72, 153)","rgb(139, 92, 246)","rgb(244, 114, 182)"],borderWidth:2}]},t={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgb(156, 163, 175)",font:{size:12}}},tooltip:{backgroundColor:"rgba(17, 24, 39, 0.9)",titleColor:"rgb(243, 244, 246)",bodyColor:"rgb(209, 213, 219)",borderColor:"rgb(168, 85, 247)",borderWidth:1}},scales:{x:{ticks:{color:"rgb(156, 163, 175)",font:{size:11}},grid:{color:"rgba(75, 85, 99, 0.2)"}},y:{ticks:{color:"rgb(156, 163, 175)",font:{size:11}},grid:{color:"rgba(75, 85, 99, 0.2)"}}}},l={...t,scales:{...t.scales,y1:{type:"linear",position:"right",ticks:{color:"rgb(156, 163, 175)",font:{size:11}},grid:{drawOnChartArea:!1}}}};return L?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(as,{className:"w-8 h-8 animate-spin text-purple-400"})}):N?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-400 mb-2",children:"Error loading analytics"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:N}),e.jsx("button",{onClick:T,className:"mt-4 px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-md text-sm",children:"Retry"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(F,{className:"bg-gradient-to-br from-purple-900/20 to-purple-800/10 border-purple-500/30",children:[e.jsx(R,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(I,{className:"text-sm font-medium text-muted-foreground",children:"Total Impressions"}),e.jsx(je,{className:"w-4 h-4 text-purple-400"})]})}),e.jsxs(E,{children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:O.totalImpressions.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Across all ads"})]})]}),e.jsxs(F,{className:"bg-gradient-to-br from-pink-900/20 to-pink-800/10 border-pink-500/30",children:[e.jsx(R,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(I,{className:"text-sm font-medium text-muted-foreground",children:"Total Clicks"}),e.jsx(Te,{className:"w-4 h-4 text-pink-400"})]})}),e.jsxs(E,{children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:O.totalClicks.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Engagement actions"})]})]}),e.jsxs(F,{className:"bg-gradient-to-br from-purple-900/20 to-pink-900/20 border-purple-500/30",children:[e.jsx(R,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(I,{className:"text-sm font-medium text-muted-foreground",children:"Average CTR"}),e.jsx(Ie,{className:"w-4 h-4 text-purple-400"})]})}),e.jsxs(E,{children:[e.jsxs("div",{className:"text-2xl font-bold text-foreground",children:[O.averageCTR.toFixed(2),"%"]}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[O.averageCTR>2?e.jsx(Ae,{className:"w-3 h-3 text-green-400"}):e.jsx(os,{className:"w-3 h-3 text-red-400"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Click-through rate"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(_,{value:f,onValueChange:C,children:[e.jsx(W,{className:"w-full sm:w-[180px]",children:e.jsx(Y,{})}),e.jsxs(Z,{children:[e.jsx(x,{value:"7d",children:"Last 7 Days"}),e.jsx(x,{value:"30d",children:"Last 30 Days"}),e.jsx(x,{value:"90d",children:"Last 90 Days"})]})]}),e.jsxs(_,{value:d,onValueChange:w,children:[e.jsx(W,{className:"w-full sm:w-[250px]",children:e.jsx(Y,{})}),e.jsxs(Z,{children:[e.jsx(x,{value:"all",children:"All Ads"}),o.map(n=>e.jsx(x,{value:n.id,children:n.title},n.id))]})]})]}),e.jsxs(ns,{defaultValue:"ctr",className:"w-full",children:[e.jsxs(cs,{className:"grid w-full grid-cols-4",children:[e.jsx(re,{value:"ctr",children:"CTR Trend"}),e.jsx(re,{value:"performance",children:"Performance"}),e.jsx(re,{value:"distribution",children:"Distribution"}),e.jsx(re,{value:"top",children:"Top Ads"})]}),e.jsx(le,{value:"ctr",className:"mt-4",children:e.jsxs(F,{children:[e.jsxs(R,{children:[e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5 text-purple-400"}),"Click-Through Rate Trend"]}),e.jsx(z,{children:"Track CTR performance over time"})]}),e.jsx(E,{children:e.jsx("div",{className:"h-[300px]",children:q.length>0?e.jsx(Ls,{data:D,options:t}):e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"No performance data available for the selected range"})})})]})}),e.jsx(le,{value:"performance",className:"mt-4",children:e.jsxs(F,{children:[e.jsxs(R,{children:[e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(ms,{className:"w-5 h-5 text-pink-400"}),"Impressions vs Clicks"]}),e.jsx(z,{children:"Compare ad visibility and engagement"})]}),e.jsx(E,{children:e.jsx("div",{className:"h-[300px]",children:q.length>0?e.jsx(Os,{data:U,options:l}):e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"No performance data available for the selected range"})})})]})}),e.jsx(le,{value:"distribution",className:"mt-4",children:e.jsxs(F,{children:[e.jsxs(R,{children:[e.jsx(I,{children:"Ad Type Distribution"}),e.jsx(z,{children:"Breakdown of ads by type"})]}),e.jsx(E,{children:e.jsx("div",{className:"h-[300px] flex items-center justify-center",children:o.length>0?e.jsx(Rs,{data:p,options:{...t,scales:void 0}}):e.jsx("div",{className:"text-muted-foreground",children:"No ads available"})})})]})}),e.jsx(le,{value:"top",className:"mt-4",children:e.jsxs(F,{children:[e.jsxs(R,{children:[e.jsx(I,{children:"Top Performing Ads"}),e.jsx(z,{children:"Ranked by click-through rate"})]}),e.jsx(E,{children:e.jsxs("div",{className:"space-y-3",children:[V.map((n,J)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg border border-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(A,{variant:"outline",className:"w-8 h-8 flex items-center justify-center",children:J+1}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:n.title}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n.type," â€¢ ",n.placement]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-lg text-purple-400",children:[n.ctr.toFixed(2),"%"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n.clicks," / ",n.impressions]})]})]},n.id)),V.length===0&&e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No ad performance data available"})]})})]})})]})]})}async function lt(){const o=await fetch("/api/admin/ads",{credentials:"include"});if(!o.ok)throw new Error("Failed to fetch advertisements");return o.json()}async function it(o){const f=await fetch(`/api/ads/analytics/variant-comparison/${o}`,{credentials:"include"});if(!f.ok)throw new Error("Failed to fetch variant comparison");return f.json()}async function nt(){const o=await fetch("/api/csrf-token",{credentials:"include"});if(!o.ok)throw new Error("Failed to fetch CSRF token");return(await o.json()).csrfToken}function ct(){const{toast:o}=ls(),f=is(),[C,d]=g.useState(!1),[w,L]=g.useState(""),[v,N]=g.useState([{variantName:"A",title:"",imageUrl:"",linkUrl:"",type:"banner",placement:"homepage",displayOrder:0},{variantName:"B",title:"",imageUrl:"",linkUrl:"",type:"banner",placement:"homepage",displayOrder:0}]),[u,O]=g.useState(new Set),{data:B,isLoading:q}=qe({queryKey:["admin-ads"],queryFn:lt}),G=B?Array.from(new Set(B.filter(m=>m.variantGroup).map(m=>m.variantGroup))):[],V=Q({mutationFn:async m=>{const b=await nt(),D={variantGroup:m.variantGroup,variants:m.variants.map(p=>({...p,isActive:"true",displayOrder:Number(p.displayOrder)||0}))},U=await fetch("/api/ads/variants",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":b},credentials:"include",body:JSON.stringify(D)});if(!U.ok){const p=await U.json();throw new Error(p.message||"Failed to create variant group")}return U.json()},onSuccess:()=>{f.invalidateQueries({queryKey:["admin-ads"]}),o({title:"Success",description:"Variant group created successfully"}),d(!1),ne()},onError:m=>{o({title:"Error",description:m.message,variant:"destructive"})}}),K=()=>{const m=String.fromCharCode(65+v.length);N([...v,{variantName:m,title:"",imageUrl:"",linkUrl:"",type:v[0]?.type||"banner",placement:v[0]?.placement||"homepage",displayOrder:v[0]?.displayOrder||0}])},k=m=>{v.length>2&&N(v.filter((b,D)=>D!==m))},T=(m,b,D)=>{const U=[...v];U[m]={...U[m],[b]:D},N(U)},ne=()=>{L(""),N([{variantName:"A",title:"",imageUrl:"",linkUrl:"",type:"banner",placement:"homepage",displayOrder:0},{variantName:"B",title:"",imageUrl:"",linkUrl:"",type:"banner",placement:"homepage",displayOrder:0}])},H=()=>{if(!w.trim()){o({title:"Error",description:"Please enter a variant group name",variant:"destructive"});return}if(v.find(b=>!b.title||!b.imageUrl||!b.linkUrl)){o({title:"Error",description:"All variants must have title, image, and link",variant:"destructive"});return}V.mutate({variantGroup:w,variants:v})},se=m=>{const b=new Set(u);b.has(m)?b.delete(m):b.add(m),O(b)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(F,{className:"bg-card/80 backdrop-blur-md border-border/50",children:[e.jsx(R,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(I,{className:"text-2xl font-bold",children:"A/B Testing"}),e.jsx(z,{className:"mt-2",children:"Create and manage ad variant groups for A/B testing"})]}),e.jsxs(j,{onClick:()=>d(!0),className:"gap-2",children:[e.jsx(Re,{className:"w-4 h-4"}),"Create Variant Group"]})]})}),e.jsx(E,{children:q?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading variant groups..."}):G.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No variant groups yet. Create your first A/B test!"}):e.jsx("div",{className:"space-y-4",children:G.map(m=>e.jsx(dt,{variantGroup:m,ads:B,expanded:u.has(m),onToggle:()=>se(m)},m))})})]}),e.jsx(ye,{open:C,onOpenChange:d,children:e.jsxs(we,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ke,{children:[e.jsx(Ce,{children:"Create A/B Test Variant Group"}),e.jsx(De,{children:"Create multiple ad variants to test which performs best"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"variantGroupName",children:"Variant Group Name"}),e.jsx(y,{id:"variantGroupName",value:w,onChange:m=>L(m.target.value),placeholder:"e.g., homepage-banner-test-1"})]}),e.jsx(X,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Variants"}),e.jsxs(j,{type:"button",variant:"outline",size:"sm",onClick:K,className:"gap-2",children:[e.jsx(Re,{className:"w-4 h-4"}),"Add Variant"]})]}),v.map((m,b)=>e.jsxs(F,{className:"border-2",children:[e.jsx(R,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(I,{className:"text-base",children:["Variant ",m.variantName]}),v.length>2&&e.jsx(j,{type:"button",variant:"ghost",size:"sm",onClick:()=>k(b),children:e.jsx(Oe,{className:"w-4 h-4"})})]})}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Title"}),e.jsx(y,{value:m.title,onChange:D=>T(b,"title",D.target.value),placeholder:"Ad title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Link URL"}),e.jsx(y,{value:m.linkUrl,onChange:D=>T(b,"linkUrl",D.target.value),placeholder:"https://..."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Image"}),e.jsx(Be,{value:m.imageUrl,onChange:D=>T(b,"imageUrl",D)})]}),b===0&&e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Type"}),e.jsxs(_,{value:m.type,onValueChange:D=>{v.forEach((U,p)=>T(p,"type",D))},children:[e.jsx(W,{children:e.jsx(Y,{})}),e.jsxs(Z,{children:[e.jsx(x,{value:"banner",children:"Banner"}),e.jsx(x,{value:"sidebar",children:"Sidebar"}),e.jsx(x,{value:"popup",children:"Popup"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Placement"}),e.jsxs(_,{value:m.placement,onValueChange:D=>{v.forEach((U,p)=>T(p,"placement",D))},children:[e.jsx(W,{children:e.jsx(Y,{})}),e.jsxs(Z,{children:[e.jsx(x,{value:"homepage",children:"Homepage"}),e.jsx(x,{value:"manga-page",children:"Manga Page"}),e.jsx(x,{value:"chapter-reader",children:"Chapter Reader"}),e.jsx(x,{value:"browse",children:"Browse"}),e.jsx(x,{value:"all",children:"All Pages"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Display Order"}),e.jsx(y,{type:"number",value:m.displayOrder,onChange:D=>{const U=parseInt(D.target.value)||0;v.forEach((p,t)=>T(t,"displayOrder",U))},min:"0"})]})]})]})]},b))]})]}),e.jsxs(Se,{children:[e.jsx(j,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(j,{onClick:H,disabled:V.isPending,children:V.isPending?"Creating...":"Create Variant Group"})]})]})})]})}function dt({variantGroup:o,ads:f,expanded:C,onToggle:d}){const{data:w,isLoading:L}=qe({queryKey:["variant-comparison",o],queryFn:()=>it(o),enabled:C}),v=f.filter(u=>u.variantGroup===o),N=w?.reduce((u,O)=>O.ctr>u.ctr?O:u,w[0]);return e.jsxs(F,{className:"border-2",children:[e.jsx(R,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(I,{className:"text-lg",children:o}),e.jsxs(A,{variant:"outline",children:[v.length," variants"]})]}),e.jsx(j,{variant:"ghost",size:"sm",onClick:d,children:C?"Hide Details":"Show Details"})]})}),C&&e.jsx(E,{children:L?e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"Loading comparison..."}):!w||w.length===0?e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No performance data yet"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.map(u=>e.jsxs(F,{className:N?.variantName===u.variantName?"border-green-500 border-2 bg-green-50 dark:bg-green-950/20":"border-border",children:[e.jsxs(R,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(I,{className:"text-base",children:["Variant ",u.variantName]}),N?.variantName===u.variantName&&e.jsxs(A,{className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Ae,{className:"w-3 h-3 mr-1"}),"Winner"]})]}),e.jsx(z,{className:"text-xs line-clamp-1",children:u.title})]}),e.jsxs(E,{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[e.jsx(je,{className:"w-3 h-3"}),"Impressions"]}),e.jsx("span",{className:"font-semibold",children:u.impressions.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[e.jsx(Te,{className:"w-3 h-3"}),"Clicks"]}),e.jsx("span",{className:"font-semibold",children:u.clicks.toLocaleString()})]}),e.jsx(X,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"CTR"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-lg font-bold",children:[u.ctr,"%"]}),N?.variantName===u.variantName?e.jsx(Ae,{className:"w-4 h-4 text-green-600"}):e.jsx(os,{className:"w-4 h-4 text-muted-foreground"})]})]})]})]},u.adId))})})]})}async function ot(){const o=await fetch("/api/admin/ads",{credentials:"include"});if(!o.ok)throw new Error("Failed to fetch advertisements");return o.json()}async function ee(){const o=await fetch("/api/csrf-token",{credentials:"include"});if(!o.ok)throw new Error("Failed to fetch CSRF token");return(await o.json()).csrfToken}function Bt(){const{isAdmin:o,isAuthenticated:f}=Fs(),[,C]=Ts(),{toast:d}=ls(),w=is(),[L,v]=g.useState(""),[N,u]=g.useState(!1),[O,B]=g.useState(!1),[q,G]=g.useState(null),[V,K]=g.useState(null),[k,T]=g.useState(new Set),[ne,H]=g.useState(!1),[se,m]=g.useState(!1),[b,D]=g.useState(null),[U,p]=g.useState([]),[t,l]=g.useState({title:"",description:"",imageUrl:"",linkUrl:"",type:"banner",placement:"homepage",displayOrder:0,startDate:"",endDate:"",isActive:!0,targetCountries:[],targetDeviceTypes:[],targetUserRoles:[],targetLanguages:[],budget:"",costPerClick:"",costPerImpression:"",conversionGoal:"",frequencyCap:0,dailyBudget:"",tags:[],notes:""}),{data:n,isLoading:J}=qe({queryKey:["admin-ads"],queryFn:ot,enabled:o&&f}),P=Q({mutationFn:async s=>{const a=await ee(),r={...s,isActive:s.isActive?"true":"false",displayOrder:Number(s.displayOrder)||0,startDate:s.startDate?.trim()||null,endDate:s.endDate?.trim()||null,targetCountries:s.targetCountries.length>0?JSON.stringify(s.targetCountries):null,targetDeviceTypes:s.targetDeviceTypes.length>0?JSON.stringify(s.targetDeviceTypes):null,targetUserRoles:s.targetUserRoles.length>0?JSON.stringify(s.targetUserRoles):null,targetLanguages:s.targetLanguages.length>0?JSON.stringify(s.targetLanguages):null,budget:s.budget?.trim()||null,costPerClick:s.costPerClick?.trim()||null,costPerImpression:s.costPerImpression?.trim()||null,conversionGoal:s.conversionGoal?.trim()||null,frequencyCap:s.frequencyCap>0?s.frequencyCap:null,dailyBudget:s.dailyBudget?.trim()||null,tags:s.tags.length>0?JSON.stringify(s.tags):null,notes:s.notes?.trim()||null};r.startDate===null&&delete r.startDate,r.endDate===null&&delete r.endDate,r.targetCountries===null&&delete r.targetCountries,r.targetDeviceTypes===null&&delete r.targetDeviceTypes,r.targetUserRoles===null&&delete r.targetUserRoles,r.targetLanguages===null&&delete r.targetLanguages,r.budget===null&&delete r.budget,r.costPerClick===null&&delete r.costPerClick,r.costPerImpression===null&&delete r.costPerImpression,r.conversionGoal===null&&delete r.conversionGoal,r.frequencyCap===null&&delete r.frequencyCap,r.dailyBudget===null&&delete r.dailyBudget,r.tags===null&&delete r.tags,r.notes===null&&delete r.notes;const c=await fetch("/api/admin/ads",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":a},credentials:"include",body:JSON.stringify(r)});if(!c.ok){const S=await c.json();throw new Error(S.message||"Failed to create advertisement")}return c.json()},onSuccess:()=>{w.invalidateQueries({queryKey:["admin-ads"]}),d({title:"Success",description:"Advertisement created successfully"}),u(!1),Ee()},onError:s=>{d({title:"Error",description:s.message||"Failed to create advertisement",variant:"destructive"})}}),oe=Q({mutationFn:async({id:s,data:a})=>{const r=await ee(),c={...a,isActive:a.isActive?"true":"false",displayOrder:Number(a.displayOrder)||0,startDate:a.startDate?.trim()||null,endDate:a.endDate?.trim()||null,targetCountries:a.targetCountries.length>0?JSON.stringify(a.targetCountries):null,targetDeviceTypes:a.targetDeviceTypes.length>0?JSON.stringify(a.targetDeviceTypes):null,targetUserRoles:a.targetUserRoles.length>0?JSON.stringify(a.targetUserRoles):null,targetLanguages:a.targetLanguages.length>0?JSON.stringify(a.targetLanguages):null,budget:a.budget?.trim()||null,costPerClick:a.costPerClick?.trim()||null,costPerImpression:a.costPerImpression?.trim()||null,conversionGoal:a.conversionGoal?.trim()||null,frequencyCap:a.frequencyCap>0?a.frequencyCap:null,dailyBudget:a.dailyBudget?.trim()||null,tags:a.tags.length>0?JSON.stringify(a.tags):null,notes:a.notes?.trim()||null};c.startDate===null&&delete c.startDate,c.endDate===null&&delete c.endDate,c.targetCountries===null&&delete c.targetCountries,c.targetDeviceTypes===null&&delete c.targetDeviceTypes,c.targetUserRoles===null&&delete c.targetUserRoles,c.targetLanguages===null&&delete c.targetLanguages,c.budget===null&&delete c.budget,c.costPerClick===null&&delete c.costPerClick,c.costPerImpression===null&&delete c.costPerImpression,c.conversionGoal===null&&delete c.conversionGoal,c.frequencyCap===null&&delete c.frequencyCap,c.dailyBudget===null&&delete c.dailyBudget,c.tags===null&&delete c.tags,c.notes===null&&delete c.notes;const S=await fetch(`/api/admin/ads/${s}`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-Token":r},credentials:"include",body:JSON.stringify(c)});if(!S.ok){const ce=await S.json();throw new Error(ce.message||"Failed to update advertisement")}return S.json()},onSuccess:()=>{w.invalidateQueries({queryKey:["admin-ads"]}),d({title:"Success",description:"Advertisement updated successfully"}),B(!1),G(null),Ee()},onError:s=>{d({title:"Error",description:s.message||"Failed to update advertisement",variant:"destructive"})}}),xe=Q({mutationFn:async s=>{const a=await ee(),r=await fetch(`/api/admin/ads/${s}`,{method:"DELETE",headers:{"X-CSRF-Token":a},credentials:"include"});if(!r.ok){const c=await r.json();throw new Error(c.message||"Failed to delete advertisement")}return r.json()},onSuccess:()=>{w.invalidateQueries({queryKey:["admin-ads"]}),d({title:"Success",description:"Advertisement deleted successfully"}),K(null)},onError:s=>{d({title:"Error",description:s.message||"Failed to delete advertisement",variant:"destructive"})}}),fe=Q({mutationFn:async({id:s,isActive:a})=>{const r=await ee(),c=await fetch(`/api/admin/ads/${s}`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-Token":r},credentials:"include",body:JSON.stringify({isActive:a?"true":"false"})});if(!c.ok){const S=await c.json();throw new Error(S.message||"Failed to toggle advertisement status")}return c.json()},onSuccess:()=>{w.invalidateQueries({queryKey:["admin-ads"]}),d({title:"Success",description:"Advertisement status updated successfully"})},onError:s=>{d({title:"Error",description:s.message||"Failed to update advertisement status",variant:"destructive"})}}),he=Q({mutationFn:async()=>{const s=await ee(),a=await fetch("/api/admin/ads/refresh-schedules",{method:"POST",headers:{"X-CSRF-Token":s},credentials:"include"});if(!a.ok){const r=await a.json();throw new Error(r.message||"Failed to refresh schedules")}return a.json()},onSuccess:s=>{w.invalidateQueries({queryKey:["admin-ads"]}),d({title:"Schedules Refreshed",description:s.message||`${s.activated} ads activated, ${s.deactivated} ads deactivated`})},onError:s=>{d({title:"Error",description:s.message||"Failed to refresh schedules",variant:"destructive"})}}),ve=Q({mutationFn:async s=>{const a=await ee(),r=await fetch("/api/admin/ads/bulk-enable",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":a},credentials:"include",body:JSON.stringify({ids:s})});if(!r.ok){const c=await r.json();throw new Error(c.message||"Failed to enable ads")}return r.json()},onSuccess:()=>{w.invalidateQueries({queryKey:["admin-ads"]}),d({title:"Success",description:`${k.size} ad(s) enabled successfully`}),T(new Set)},onError:s=>{d({title:"Error",description:s.message||"Failed to enable ads",variant:"destructive"})}}),Ne=Q({mutationFn:async s=>{const a=await ee(),r=await fetch("/api/admin/ads/bulk-disable",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":a},credentials:"include",body:JSON.stringify({ids:s})});if(!r.ok){const c=await r.json();throw new Error(c.message||"Failed to disable ads")}return r.json()},onSuccess:()=>{w.invalidateQueries({queryKey:["admin-ads"]}),d({title:"Success",description:`${k.size} ad(s) disabled successfully`}),T(new Set)},onError:s=>{d({title:"Error",description:s.message||"Failed to disable ads",variant:"destructive"})}}),$e=Q({mutationFn:async s=>{const a=await ee(),r=await fetch("/api/admin/ads/bulk-delete",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":a},credentials:"include",body:JSON.stringify({ids:s})});if(!r.ok){const c=await r.json();throw new Error(c.message||"Failed to delete ads")}return r.json()},onSuccess:()=>{w.invalidateQueries({queryKey:["admin-ads"]}),d({title:"Success",description:`${k.size} ad(s) deleted successfully`}),T(new Set),H(!1)},onError:s=>{d({title:"Error",description:s.message||"Failed to delete ads",variant:"destructive"})}}),Ve=Q({mutationFn:async s=>{const a=await ee(),r=await fetch("/api/admin/ads/import",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":a},credentials:"include",body:JSON.stringify({ads:s})});if(!r.ok){const c=await r.json();throw new Error(c.message||"Failed to import ads")}return r.json()},onSuccess:s=>{w.invalidateQueries({queryKey:["admin-ads"]}),s.errors&&s.errors.length>0?(p(s.errors),d({title:"Partial Import",description:`${s.success} ad(s) imported, ${s.errors.length} error(s)`,variant:"destructive"})):(d({title:"Success",description:`${s.success} ad(s) imported successfully`}),m(!1),D(null),p([]))},onError:s=>{d({title:"Error",description:s.message||"Failed to import ads",variant:"destructive"})}}),Fe=s=>{const a=new Date().toISOString();return!s.startDate&&!s.endDate?{status:"",badge:"",color:""}:s.endDate&&s.endDate<=a?{status:"expired",badge:"Expired",color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"}:s.startDate&&s.startDate>a?{status:"upcoming",badge:"Upcoming",color:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300"}:s.startDate&&s.startDate<=a&&(!s.endDate||s.endDate>a)?{status:"active",badge:"Active",color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300"}:{status:"",badge:"",color:""}},hs=s=>{const a=new Set(k);a.has(s)?a.delete(s):a.add(s),T(a)},Ge=async s=>{try{const a=await fetch(`/api/admin/ads/export?format=${s}`,{credentials:"include"});if(!a.ok)throw new Error("Failed to export ads");const r=await a.blob(),c=window.URL.createObjectURL(r),S=document.createElement("a");S.href=c,S.download=`ads-export-${new Date().toISOString().split("T")[0]}.${s}`,document.body.appendChild(S),S.click(),window.URL.revokeObjectURL(c),document.body.removeChild(S),d({title:"Success",description:`Ads exported as ${s.toUpperCase()} successfully`})}catch(a){d({title:"Error",description:a instanceof Error?a.message:"Failed to export ads",variant:"destructive"})}},us=async s=>{const a=s.target.files?.[0];if(!a)return;D(a),p([]);const r=a.name.split(".").pop()?.toLowerCase();if(r==="json"){const c=await a.text();try{const S=JSON.parse(c);if(!Array.isArray(S))throw new Error("JSON must be an array of advertisements");Ve.mutate(S)}catch(S){d({title:"Error",description:S instanceof Error?S.message:"Invalid JSON format",variant:"destructive"})}}else if(r==="csv"){const S=(await a.text()).split(`
`).filter(ue=>ue.trim());if(S.length<2){d({title:"Error",description:"CSV file must have headers and at least one data row",variant:"destructive"});return}const ce=S[0].split(",").map(ue=>ue.trim()),h=S.slice(1).map((ue,mt)=>{const Ds=ue.split(",").map($=>$.trim()),pe={};return ce.forEach(($,Ss)=>{const de=Ds[Ss]||"";$==="targetCountries"||$==="targetDeviceTypes"||$==="targetUserRoles"||$==="targetLanguages"||$==="tags"?pe[$]=de?JSON.stringify(de.split("|").map(As=>As.trim())):null:$==="displayOrder"||$==="frequencyCap"?pe[$]=de?parseInt(de):0:$==="isActive"?pe[$]=de==="true"?"true":"false":de&&(pe[$]=de)}),pe});Ve.mutate(h)}else d({title:"Error",description:"Please upload a CSV or JSON file",variant:"destructive"})};if(!f||!o)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-background/95 flex items-center justify-center p-4",children:e.jsxs(F,{className:"max-w-md w-full bg-card/80 backdrop-blur-md border-border/50",children:[e.jsxs(R,{className:"text-center",children:[e.jsx(I,{children:"Admin Access Required"}),e.jsx(z,{children:"You need admin privileges to access advertisement management"})]}),e.jsx(E,{children:e.jsx(j,{onClick:()=>C("/"),className:"w-full",children:"Return to Home"})})]})});const Ee=()=>{l({title:"",description:"",imageUrl:"",linkUrl:"",type:"banner",placement:"homepage",displayOrder:0,startDate:"",endDate:"",isActive:!0,targetCountries:[],targetDeviceTypes:[],targetUserRoles:[],targetLanguages:[],budget:"",costPerClick:"",costPerImpression:"",conversionGoal:"",frequencyCap:0,dailyBudget:"",tags:[],notes:""})},ps=()=>{if(!t.title.trim()){d({title:"Validation Error",description:"Title is required",variant:"destructive"});return}if(!t.imageUrl.trim()){d({title:"Validation Error",description:"Image URL is required",variant:"destructive"});return}if(!t.linkUrl.trim()){d({title:"Validation Error",description:"Link URL is required",variant:"destructive"});return}if(t.startDate&&t.endDate){const s=new Date(t.startDate),a=new Date(t.endDate);if(s>=a){d({title:"Validation Error",description:"Start date must be before end date",variant:"destructive"});return}}P.mutate(t)},gs=()=>{if(q){if(!t.title.trim()){d({title:"Validation Error",description:"Title is required",variant:"destructive"});return}if(!t.imageUrl.trim()){d({title:"Validation Error",description:"Image URL is required",variant:"destructive"});return}if(!t.linkUrl.trim()){d({title:"Validation Error",description:"Link URL is required",variant:"destructive"});return}if(t.startDate&&t.endDate){const s=new Date(t.startDate),a=new Date(t.endDate);if(s>=a){d({title:"Validation Error",description:"Start date must be before end date",variant:"destructive"});return}}oe.mutate({id:q.id,data:t})}},js=()=>{V&&xe.mutate(V)},fs=s=>{G(s);const a=r=>{if(!r)return[];try{return JSON.parse(r)}catch{return[]}};l({title:s.title,description:s.description||"",imageUrl:s.imageUrl,linkUrl:s.linkUrl,type:s.type,placement:s.placement,displayOrder:s.displayOrder,startDate:s.startDate||"",endDate:s.endDate||"",isActive:s.isActive==="true",targetCountries:a(s.targetCountries),targetDeviceTypes:a(s.targetDeviceTypes),targetUserRoles:a(s.targetUserRoles),targetLanguages:a(s.targetLanguages),budget:s.budget||"",costPerClick:s.costPerClick||"",costPerImpression:s.costPerImpression||"",conversionGoal:s.conversionGoal||"",frequencyCap:s.frequencyCap||0,dailyBudget:s.dailyBudget||"",tags:a(s.tags),notes:s.notes||""}),B(!0)},te=n?.filter(s=>s.title.toLowerCase().includes(L.toLowerCase())||s.type.toLowerCase().includes(L.toLowerCase())||s.placement.toLowerCase().includes(L.toLowerCase()))||[],vs=()=>{k.size===te.length?T(new Set):T(new Set(te.map(s=>s.id)))},Ns=te.length>0&&k.size===te.length,bs=k.size>0&&k.size<te.length,ys=n?.length||0,ws=n?.filter(s=>s.isActive==="true").length||0,ks=n?.reduce((s,a)=>s+a.clickCount,0)||0,Cs=n?.reduce((s,a)=>s+a.impressionCount,0)||0;return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-background/95 p-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs(j,{variant:"ghost",onClick:()=>C("/admin"),className:"text-muted-foreground hover:text-primary",children:[e.jsx(Es,{className:"w-4 h-4 mr-2"}),"Back to Admin"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-8 h-8 text-primary"}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-primary via-accent to-purple-400 bg-clip-text text-transparent",children:"Advertisement Management"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(F,{className:"bg-card/80 backdrop-blur-md border-border/50",children:e.jsx(E,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Ads"}),e.jsx("p",{className:"text-2xl font-bold",children:ys})]}),e.jsx(me,{className:"w-8 h-8 text-primary"})]})})}),e.jsx(F,{className:"bg-card/80 backdrop-blur-md border-border/50",children:e.jsx(E,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Active Ads"}),e.jsx("p",{className:"text-2xl font-bold",children:ws})]}),e.jsx(Ye,{className:"w-8 h-8 text-green-500"})]})})}),e.jsx(F,{className:"bg-card/80 backdrop-blur-md border-border/50",children:e.jsx(E,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Clicks"}),e.jsx("p",{className:"text-2xl font-bold",children:ks.toLocaleString()})]}),e.jsx(Te,{className:"w-8 h-8 text-accent"})]})})}),e.jsx(F,{className:"bg-card/80 backdrop-blur-md border-border/50",children:e.jsx(E,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Impressions"}),e.jsx("p",{className:"text-2xl font-bold",children:Cs.toLocaleString()})]}),e.jsx(je,{className:"w-8 h-8 text-purple-500"})]})})})]}),e.jsx("div",{className:"mb-8",children:e.jsx(Qs,{})}),e.jsxs(ns,{defaultValue:"ads",className:"w-full",children:[e.jsxs(cs,{className:"grid w-full max-w-3xl grid-cols-2 md:grid-cols-4 mb-6",children:[e.jsxs(re,{value:"ads",className:"flex items-center gap-1 md:gap-2 text-xs md:text-sm",children:[e.jsx(me,{className:"w-3 h-3 md:w-4 md:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Ads Management"}),e.jsx("span",{className:"sm:hidden",children:"Ads"})]}),e.jsxs(re,{value:"schedule",className:"flex items-center gap-1 md:gap-2 text-xs md:text-sm",children:[e.jsx(Me,{className:"w-3 h-3 md:w-4 md:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Schedule"}),e.jsx("span",{className:"sm:hidden",children:"Schedule"})]}),e.jsxs(re,{value:"analytics",className:"flex items-center gap-1 md:gap-2 text-xs md:text-sm",children:[e.jsx(ms,{className:"w-3 h-3 md:w-4 md:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Analytics"}),e.jsx("span",{className:"sm:hidden",children:"Analytics"})]}),e.jsxs(re,{value:"ab-testing",className:"flex items-center gap-1 md:gap-2 text-xs md:text-sm",children:[e.jsx(ss,{className:"w-3 h-3 md:w-4 md:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"A/B Testing"}),e.jsx("span",{className:"sm:hidden",children:"A/B Test"})]})]}),e.jsxs(le,{value:"ads",className:"mt-0",children:[k.size>0&&e.jsx("div",{className:"sticky top-0 z-10 mb-4 p-4 bg-primary/10 border border-primary/20 rounded-lg backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xs,{className:"w-5 h-5 text-primary"}),e.jsxs("span",{className:"font-medium",children:[k.size," ad(s) selected"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(j,{variant:"outline",onClick:()=>ve.mutate(Array.from(k)),disabled:ve.isPending,className:"h-10 sm:h-9",children:[e.jsx(st,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Enable Selected"}),e.jsx("span",{className:"sm:hidden",children:"Enable"})]}),e.jsxs(j,{variant:"outline",onClick:()=>Ne.mutate(Array.from(k)),disabled:Ne.isPending,className:"h-10 sm:h-9",children:[e.jsx(et,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Disable Selected"}),e.jsx("span",{className:"sm:hidden",children:"Disable"})]}),e.jsxs(j,{variant:"destructive",onClick:()=>H(!0),className:"h-10 sm:h-9",children:[e.jsx(Oe,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Delete Selected"}),e.jsx("span",{className:"sm:hidden",children:"Delete"})]}),e.jsxs(j,{variant:"ghost",onClick:()=>T(new Set),className:"h-10 sm:h-9",children:[e.jsx(Ue,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Clear Selection"}),e.jsx("span",{className:"sm:hidden",children:"Clear"})]})]})]})}),e.jsxs(F,{className:"bg-card/80 backdrop-blur-md border-border/50",children:[e.jsx(R,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-5 h-5"}),"All Advertisements"]}),e.jsx(z,{children:"Manage and monitor your advertisements"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 w-full sm:w-auto",children:[e.jsxs(j,{variant:"outline",onClick:()=>Ge("csv"),className:"flex-1 sm:flex-none h-10 sm:h-9",children:[e.jsx(Ze,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Export CSV"}),e.jsx("span",{className:"sm:hidden",children:"CSV"})]}),e.jsxs(j,{variant:"outline",onClick:()=>Ge("json"),className:"flex-1 sm:flex-none h-10 sm:h-9",children:[e.jsx(Ze,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Export JSON"}),e.jsx("span",{className:"sm:hidden",children:"JSON"})]}),e.jsxs(j,{variant:"outline",onClick:()=>m(!0),className:"flex-1 sm:flex-none h-10 sm:h-9",children:[e.jsx(rs,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Import"}),e.jsx("span",{className:"sm:hidden",children:"Import"})]}),e.jsxs(j,{variant:"outline",onClick:()=>he.mutate(),disabled:he.isPending,className:"flex-1 sm:flex-none h-10 sm:h-9",children:[e.jsx(Ps,{className:`w-4 h-4 sm:mr-2 ${he.isPending?"animate-spin":""}`}),e.jsx("span",{className:"hidden sm:inline",children:"Refresh"}),e.jsx("span",{className:"sm:hidden",children:"Refresh"})]}),e.jsxs(j,{onClick:()=>{Ee(),u(!0)},className:"w-full sm:w-auto h-10 sm:h-9",children:[e.jsx(Re,{className:"w-4 h-4 mr-2"}),"Create New Ad"]})]})]})}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Us,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(y,{placeholder:"Search ads by title, type, or placement...",value:L,onChange:s=>v(s.target.value),className:"pl-10 bg-background/50"})]}),te.length>0&&e.jsxs("div",{className:"flex items-center gap-2 justify-end sm:justify-start",children:[e.jsx(M,{checked:Ns,onCheckedChange:vs,className:bs?"data-[state=checked]:bg-primary/50":""}),e.jsx("span",{className:"text-sm text-muted-foreground whitespace-nowrap",children:"Select All"})]})]}),J?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading advertisements..."})}):te.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(me,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:L?"No advertisements found matching your search.":"No advertisements yet. Create your first ad!"})]}):e.jsx("div",{className:"space-y-4",children:te.map(s=>e.jsxs("div",{className:"flex flex-col sm:flex-row items-start gap-4 p-4 bg-background/50 rounded-lg border border-border/50",children:[e.jsxs("div",{className:"flex gap-3 sm:gap-4 w-full sm:w-auto",children:[e.jsx(M,{checked:k.has(s.id),onCheckedChange:()=>hs(s.id),className:"mt-1"}),e.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 bg-muted rounded-lg overflow-hidden flex-shrink-0",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(ds,{className:"w-8 h-8 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 sm:hidden",children:[e.jsx("h3",{className:"font-semibold text-base",children:s.title}),e.jsx("div",{className:"flex gap-2 mt-1",children:e.jsx(A,{className:s.isActive==="true"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300 text-xs":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300 text-xs",children:s.isActive==="true"?"Active":"Inactive"})})]})]}),e.jsxs("div",{className:"flex-1 min-w-0 w-full sm:w-auto",children:[e.jsxs("div",{className:"hidden sm:flex flex-wrap items-start justify-between gap-2 mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.title}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.description})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(A,{className:s.isActive==="true"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300",children:s.isActive==="true"?"Active":"Inactive"}),Fe(s).badge&&e.jsx(A,{className:Fe(s).color,children:Fe(s).badge})]})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1 mb-2 sm:hidden",children:s.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsxs(A,{variant:"secondary",children:["Type: ",s.type]}),e.jsxs(A,{variant:"secondary",children:["Placement: ",s.placement]}),e.jsxs(A,{variant:"secondary",children:["Order: ",s.displayOrder]}),s.variantGroup&&e.jsxs(A,{className:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",children:[e.jsx(ss,{className:"w-3 h-3 mr-1"}),"Variant ",s.variantName," (",s.variantGroup,")"]}),s.startDate&&e.jsxs(A,{variant:"outline",className:"text-xs",children:[e.jsx(ge,{className:"w-3 h-3 mr-1"}),"Start: ",new Date(s.startDate).toLocaleDateString()]}),s.endDate&&e.jsxs(A,{variant:"outline",className:"text-xs",children:[e.jsx(ge,{className:"w-3 h-3 mr-1"}),"End: ",new Date(s.endDate).toLocaleDateString()]}),s.targetCountries&&(()=>{try{const a=JSON.parse(s.targetCountries);if(a.length>0)return e.jsxs(A,{className:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",children:[e.jsx(_s,{className:"w-3 h-3 mr-1"}),a.slice(0,3).join(", "),a.length>3?` +${a.length-3}`:""]})}catch{}return null})(),s.targetDeviceTypes&&(()=>{try{const a=JSON.parse(s.targetDeviceTypes);if(a.length>0)return e.jsxs(A,{className:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300",children:[e.jsx(xs,{className:"w-3 h-3 mr-1"}),a.join(", ")]})}catch{}return null})(),s.targetUserRoles&&(()=>{try{const a=JSON.parse(s.targetUserRoles);if(a.length>0)return e.jsxs(A,{className:"bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-300",children:[e.jsx(Ws,{className:"w-3 h-3 mr-1"}),a.join(", ")]})}catch{}return null})(),s.targetLanguages&&(()=>{try{const a=JSON.parse(s.targetLanguages);if(a.length>0)return e.jsxs(A,{className:"bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-300",children:[e.jsx(Zs,{className:"w-3 h-3 mr-1"}),a.slice(0,2).join(", "),a.length>2?` +${a.length-2}`:""]})}catch{}return null})(),s.budget&&e.jsxs(A,{className:"bg-emerald-100 text-emerald-800 dark:bg-emerald-900 dark:text-emerald-300",children:[e.jsx(Pe,{className:"w-3 h-3 mr-1"}),"Budget: $",s.budget]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Te,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.clickCount," clicks"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(je,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.impressionCount," impressions"]})]}),e.jsxs("a",{href:s.linkUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-primary hover:underline",children:[e.jsx(Le,{className:"w-4 h-4"}),e.jsx("span",{className:"truncate max-w-[200px]",children:s.linkUrl})]})]})]}),e.jsxs("div",{className:"flex flex-row sm:flex-col gap-2 w-full sm:w-auto mt-3 sm:mt-0",children:[e.jsxs(j,{variant:"outline",onClick:()=>fe.mutate({id:s.id,isActive:s.isActive!=="true"}),className:"flex-1 sm:flex-none h-10 sm:h-9",children:[e.jsx("span",{className:"hidden sm:inline",children:s.isActive==="true"?"Deactivate":"Activate"}),e.jsx("span",{className:"sm:hidden",children:s.isActive==="true"?"Off":"On"})]}),e.jsxs(j,{variant:"outline",onClick:()=>fs(s),className:"flex-1 sm:flex-none h-10 sm:h-9",children:[e.jsx(Ys,{className:"w-4 h-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),e.jsxs(j,{variant:"destructive",onClick:()=>K(s.id),className:"flex-1 sm:flex-none h-10 sm:h-9",children:[e.jsx(Oe,{className:"w-4 h-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Delete"})]})]})]},s.id))})]})]})]}),e.jsx(le,{value:"schedule",className:"mt-0",children:e.jsx("div",{className:"space-y-4",children:(()=>{const s=new Date().toISOString(),a=n?.filter(h=>h.startDate&&h.startDate>s)||[],r=n?.filter(h=>h.isActive==="true"&&h.startDate&&h.startDate<=s&&(!h.endDate||h.endDate>s))||[],c=n?.filter(h=>h.endDate&&h.endDate<=s)||[],S=new Date(Date.now()-10080*60*1e3).toISOString(),ce=c.filter(h=>h.endDate&&h.endDate>=S);return e.jsxs(e.Fragment,{children:[e.jsxs(F,{className:"bg-card/80 backdrop-blur-md border-border/50",children:[e.jsxs(R,{children:[e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5 text-blue-500"}),"Upcoming Ads (",a.length,")"]}),e.jsx(z,{children:"Ads scheduled to start in the future"})]}),e.jsx(E,{children:a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No upcoming scheduled ads"}):e.jsx("div",{className:"space-y-3",children:a.map(h=>e.jsx("div",{className:"p-3 bg-background/50 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:h.title}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[e.jsx(ge,{className:"w-3 h-3 inline mr-1"}),"Starts: ",new Date(h.startDate).toLocaleDateString()," at ",new Date(h.startDate).toLocaleTimeString()]}),h.endDate&&e.jsxs("span",{className:"text-muted-foreground",children:["â€¢ Ends: ",new Date(h.endDate).toLocaleDateString()]})]})]}),e.jsx(A,{className:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",children:"Upcoming"})]})},h.id))})})]}),e.jsxs(F,{className:"bg-card/80 backdrop-blur-md border-border/50",children:[e.jsxs(R,{children:[e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(Ye,{className:"w-5 h-5 text-green-500"}),"Currently Active Scheduled Ads (",r.length,")"]}),e.jsx(z,{children:"Active ads with scheduled end dates"})]}),e.jsx(E,{children:r.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No active scheduled ads"}):e.jsx("div",{className:"space-y-3",children:r.map(h=>e.jsx("div",{className:"p-3 bg-background/50 rounded-lg border border-green-200 dark:border-green-800",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:h.title}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[e.jsx(ge,{className:"w-3 h-3 inline mr-1"}),"Ends: ",new Date(h.endDate).toLocaleDateString()," at ",new Date(h.endDate).toLocaleTimeString()]}),e.jsxs("span",{className:"text-green-600 dark:text-green-400",children:["â€¢ ",h.clickCount," clicks, ",h.impressionCount," impressions"]})]})]}),e.jsx(A,{className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",children:"Active"})]})},h.id))})})]}),e.jsxs(F,{className:"bg-card/80 backdrop-blur-md border-border/50",children:[e.jsxs(R,{children:[e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"w-5 h-5 text-red-500"}),"Recently Expired (",ce.length,")"]}),e.jsx(z,{children:"Ads that expired in the last 7 days"})]}),e.jsx(E,{children:ce.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No recently expired ads"}):e.jsx("div",{className:"space-y-3",children:ce.map(h=>e.jsx("div",{className:"p-3 bg-background/50 rounded-lg border border-red-200 dark:border-red-800",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:h.title}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[e.jsx(ge,{className:"w-3 h-3 inline mr-1"}),"Expired: ",new Date(h.endDate).toLocaleDateString()," at ",new Date(h.endDate).toLocaleTimeString()]}),e.jsxs("span",{className:"text-red-600 dark:text-red-400",children:["â€¢ Final stats: ",h.clickCount," clicks, ",h.impressionCount," impressions"]})]})]}),e.jsx(A,{className:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",children:"Expired"})]})},h.id))})})]})]})})()})}),e.jsx(le,{value:"analytics",className:"mt-0",children:e.jsx(rt,{ads:n||[]})}),e.jsx(le,{value:"ab-testing",className:"mt-0",children:e.jsx(ct,{})})]}),e.jsx(ye,{open:N,onOpenChange:u,children:e.jsxs(we,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ke,{children:[e.jsx(Ce,{children:"Create New Advertisement"}),e.jsx(De,{children:"Add a new advertisement to display on your site"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-title",children:"Title *"}),e.jsx(y,{id:"create-title",value:t.title,onChange:s=>l({...t,title:s.target.value}),placeholder:"Enter ad title"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-description",children:"Description"}),e.jsx(be,{id:"create-description",value:t.description,onChange:s=>l({...t,description:s.target.value}),placeholder:"Enter ad description (optional)",rows:3})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Ad Image *"}),e.jsx(Be,{value:t.imageUrl,onChange:s=>l({...t,imageUrl:s}),accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",maxSize:10,uploadEndpoint:"/api/admin/upload-ad-image"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-linkUrl",children:"Link URL *"}),e.jsx(y,{id:"create-linkUrl",value:t.linkUrl,onChange:s=>l({...t,linkUrl:s.target.value}),placeholder:"https://example.com/landing-page"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-type",children:"Type"}),e.jsxs(_,{value:t.type,onValueChange:s=>l({...t,type:s}),children:[e.jsx(W,{id:"create-type",children:e.jsx(Y,{})}),e.jsxs(Z,{children:[e.jsx(x,{value:"banner",children:"Banner"}),e.jsx(x,{value:"sidebar",children:"Sidebar"}),e.jsx(x,{value:"popup",children:"Popup"}),e.jsx(x,{value:"inline",children:"Inline"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-placement",children:"Placement"}),e.jsxs(_,{value:t.placement,onValueChange:s=>l({...t,placement:s}),children:[e.jsx(W,{id:"create-placement",children:e.jsx(Y,{})}),e.jsxs(Z,{children:[e.jsx(x,{value:"homepage",children:"Homepage"}),e.jsx(x,{value:"manga-page",children:"Manga Page"}),e.jsx(x,{value:"chapter-reader",children:"Chapter Reader"}),e.jsx(x,{value:"browse",children:"Browse"}),e.jsx(x,{value:"all",children:"All Pages"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-displayOrder",children:"Display Order"}),e.jsx(y,{id:"create-displayOrder",type:"number",value:t.displayOrder,onChange:s=>l({...t,displayOrder:parseInt(s.target.value)||0}),placeholder:"0"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-startDate",children:"Start Date (Optional)"}),e.jsx(y,{id:"create-startDate",type:"datetime-local",value:t.startDate,onChange:s=>l({...t,startDate:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-endDate",children:"End Date (Optional)"}),e.jsx(y,{id:"create-endDate",type:"datetime-local",value:t.endDate,onChange:s=>l({...t,endDate:s.target.value})})]})]}),e.jsx(X,{className:"my-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Ie,{className:"w-4 h-4"}),"Advanced Targeting"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Leave empty to target all users"}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs",children:"Target Countries"}),e.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:["US","UK","CA","AU","DE","FR","JP","ES","IT","BR"].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:`create-country-${s}`,checked:t.targetCountries.includes(s),onCheckedChange:a=>{l({...t,targetCountries:a?[...t.targetCountries,s]:t.targetCountries.filter(r=>r!==s)})}}),e.jsx(i,{htmlFor:`create-country-${s}`,className:"text-xs cursor-pointer",children:s})]},s))})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs",children:"Target Device Types"}),e.jsx("div",{className:"flex gap-4 mt-2",children:["mobile","tablet","desktop"].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:`create-device-${s}`,checked:t.targetDeviceTypes.includes(s),onCheckedChange:a=>{l({...t,targetDeviceTypes:a?[...t.targetDeviceTypes,s]:t.targetDeviceTypes.filter(r=>r!==s)})}}),e.jsx(i,{htmlFor:`create-device-${s}`,className:"text-xs cursor-pointer capitalize",children:s})]},s))})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs",children:"Target User Roles"}),e.jsx("div",{className:"flex gap-4 mt-2",children:["user","premium","staff","admin"].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:`create-role-${s}`,checked:t.targetUserRoles.includes(s),onCheckedChange:a=>{l({...t,targetUserRoles:a?[...t.targetUserRoles,s]:t.targetUserRoles.filter(r=>r!==s)})}}),e.jsx(i,{htmlFor:`create-role-${s}`,className:"text-xs cursor-pointer capitalize",children:s})]},s))})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs",children:"Target Languages"}),e.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[{code:"en",name:"English"},{code:"es",name:"Spanish"},{code:"fr",name:"French"},{code:"de",name:"German"},{code:"ja",name:"Japanese"},{code:"zh",name:"Chinese"}].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:`create-lang-${s.code}`,checked:t.targetLanguages.includes(s.code),onCheckedChange:a=>{l({...t,targetLanguages:a?[...t.targetLanguages,s.code]:t.targetLanguages.filter(r=>r!==s.code)})}}),e.jsx(i,{htmlFor:`create-lang-${s.code}`,className:"text-xs cursor-pointer",children:s.name})]},s.code))})]})]}),e.jsx(X,{className:"my-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Pe,{className:"w-4 h-4"}),"Performance & Budget"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-budget",className:"text-xs",children:"Total Budget ($)"}),e.jsx(y,{id:"create-budget",value:t.budget,onChange:s=>l({...t,budget:s.target.value}),placeholder:"e.g., 1000.00",className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-dailyBudget",className:"text-xs",children:"Daily Budget ($)"}),e.jsx(y,{id:"create-dailyBudget",value:t.dailyBudget,onChange:s=>l({...t,dailyBudget:s.target.value}),placeholder:"e.g., 50.00",className:"text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-costPerClick",className:"text-xs",children:"Cost Per Click ($)"}),e.jsx(y,{id:"create-costPerClick",value:t.costPerClick,onChange:s=>l({...t,costPerClick:s.target.value}),placeholder:"e.g., 0.50",className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-costPerImpression",className:"text-xs",children:"Cost Per Impression ($)"}),e.jsx(y,{id:"create-costPerImpression",value:t.costPerImpression,onChange:s=>l({...t,costPerImpression:s.target.value}),placeholder:"e.g., 0.01",className:"text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-conversionGoal",className:"text-xs",children:"Conversion Goal"}),e.jsxs(_,{value:t.conversionGoal,onValueChange:s=>l({...t,conversionGoal:s}),children:[e.jsx(W,{id:"create-conversionGoal",className:"text-sm",children:e.jsx(Y,{placeholder:"Select goal"})}),e.jsxs(Z,{children:[e.jsx(x,{value:"click",children:"Click"}),e.jsx(x,{value:"signup",children:"Sign Up"}),e.jsx(x,{value:"purchase",children:"Purchase"}),e.jsx(x,{value:"download",children:"Download"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-frequencyCap",className:"text-xs",children:"Frequency Cap (per user/day)"}),e.jsx(y,{id:"create-frequencyCap",type:"number",value:t.frequencyCap||"",onChange:s=>l({...t,frequencyCap:parseInt(s.target.value)||0}),placeholder:"e.g., 3",className:"text-sm"})]})]})]}),e.jsx(X,{className:"my-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(es,{className:"w-4 h-4"}),"Metadata"]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-tags",className:"text-xs",children:"Tags (comma-separated)"}),e.jsx(y,{id:"create-tags",value:t.tags.join(", "),onChange:s=>{const a=s.target.value.split(",").map(r=>r.trim()).filter(r=>r);l({...t,tags:a})},placeholder:"e.g., seasonal, promo, featured",className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-notes",className:"text-xs",children:"Internal Notes"}),e.jsx(be,{id:"create-notes",value:t.notes,onChange:s=>l({...t,notes:s.target.value}),placeholder:"Add internal notes for this ad...",rows:3,className:"text-sm"})]})]}),e.jsx(X,{className:"my-4"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:"create-isActive",checked:t.isActive,onCheckedChange:s=>l({...t,isActive:s})}),e.jsx(i,{htmlFor:"create-isActive",className:"cursor-pointer",children:"Active (Display this ad immediately)"})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsx(ts,{title:t.title,description:t.description,imageUrl:t.imageUrl,linkUrl:t.linkUrl,type:t.type,placement:t.placement})})]}),e.jsxs(Se,{children:[e.jsx(j,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),e.jsx(j,{onClick:ps,disabled:P.isPending,children:P.isPending?"Creating...":"Create Ad"})]})]})}),e.jsx(ye,{open:O,onOpenChange:B,children:e.jsxs(we,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ke,{children:[e.jsx(Ce,{children:"Edit Advertisement"}),e.jsx(De,{children:"Update advertisement details"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-title",children:"Title *"}),e.jsx(y,{id:"edit-title",value:t.title,onChange:s=>l({...t,title:s.target.value}),placeholder:"Enter ad title"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-description",children:"Description"}),e.jsx(be,{id:"edit-description",value:t.description,onChange:s=>l({...t,description:s.target.value}),placeholder:"Enter ad description (optional)",rows:3})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Ad Image *"}),e.jsx(Be,{value:t.imageUrl,onChange:s=>l({...t,imageUrl:s}),accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",maxSize:10,uploadEndpoint:"/api/admin/upload-ad-image"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-linkUrl",children:"Link URL *"}),e.jsx(y,{id:"edit-linkUrl",value:t.linkUrl,onChange:s=>l({...t,linkUrl:s.target.value}),placeholder:"https://example.com/landing-page"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-type",children:"Type"}),e.jsxs(_,{value:t.type,onValueChange:s=>l({...t,type:s}),children:[e.jsx(W,{id:"edit-type",children:e.jsx(Y,{})}),e.jsxs(Z,{children:[e.jsx(x,{value:"banner",children:"Banner"}),e.jsx(x,{value:"sidebar",children:"Sidebar"}),e.jsx(x,{value:"popup",children:"Popup"}),e.jsx(x,{value:"inline",children:"Inline"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-placement",children:"Placement"}),e.jsxs(_,{value:t.placement,onValueChange:s=>l({...t,placement:s}),children:[e.jsx(W,{id:"edit-placement",children:e.jsx(Y,{})}),e.jsxs(Z,{children:[e.jsx(x,{value:"homepage",children:"Homepage"}),e.jsx(x,{value:"manga-page",children:"Manga Page"}),e.jsx(x,{value:"chapter-reader",children:"Chapter Reader"}),e.jsx(x,{value:"browse",children:"Browse"}),e.jsx(x,{value:"all",children:"All Pages"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-displayOrder",children:"Display Order"}),e.jsx(y,{id:"edit-displayOrder",type:"number",value:t.displayOrder,onChange:s=>l({...t,displayOrder:parseInt(s.target.value)||0}),placeholder:"0"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-startDate",children:"Start Date (Optional)"}),e.jsx(y,{id:"edit-startDate",type:"datetime-local",value:t.startDate,onChange:s=>l({...t,startDate:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-endDate",children:"End Date (Optional)"}),e.jsx(y,{id:"edit-endDate",type:"datetime-local",value:t.endDate,onChange:s=>l({...t,endDate:s.target.value})})]})]}),e.jsx(X,{className:"my-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Ie,{className:"w-4 h-4"}),"Advanced Targeting"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Leave empty to target all users"}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs",children:"Target Countries"}),e.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:["US","UK","CA","AU","DE","FR","JP","ES","IT","BR"].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:`edit-country-${s}`,checked:t.targetCountries.includes(s),onCheckedChange:a=>{l({...t,targetCountries:a?[...t.targetCountries,s]:t.targetCountries.filter(r=>r!==s)})}}),e.jsx(i,{htmlFor:`edit-country-${s}`,className:"text-xs cursor-pointer",children:s})]},s))})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs",children:"Target Device Types"}),e.jsx("div",{className:"flex gap-4 mt-2",children:["mobile","tablet","desktop"].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:`edit-device-${s}`,checked:t.targetDeviceTypes.includes(s),onCheckedChange:a=>{l({...t,targetDeviceTypes:a?[...t.targetDeviceTypes,s]:t.targetDeviceTypes.filter(r=>r!==s)})}}),e.jsx(i,{htmlFor:`edit-device-${s}`,className:"text-xs cursor-pointer capitalize",children:s})]},s))})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs",children:"Target User Roles"}),e.jsx("div",{className:"flex gap-4 mt-2",children:["user","premium","staff","admin"].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:`edit-role-${s}`,checked:t.targetUserRoles.includes(s),onCheckedChange:a=>{l({...t,targetUserRoles:a?[...t.targetUserRoles,s]:t.targetUserRoles.filter(r=>r!==s)})}}),e.jsx(i,{htmlFor:`edit-role-${s}`,className:"text-xs cursor-pointer capitalize",children:s})]},s))})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs",children:"Target Languages"}),e.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[{code:"en",name:"English"},{code:"es",name:"Spanish"},{code:"fr",name:"French"},{code:"de",name:"German"},{code:"ja",name:"Japanese"},{code:"zh",name:"Chinese"}].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:`edit-lang-${s.code}`,checked:t.targetLanguages.includes(s.code),onCheckedChange:a=>{l({...t,targetLanguages:a?[...t.targetLanguages,s.code]:t.targetLanguages.filter(r=>r!==s.code)})}}),e.jsx(i,{htmlFor:`edit-lang-${s.code}`,className:"text-xs cursor-pointer",children:s.name})]},s.code))})]})]}),e.jsx(X,{className:"my-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Pe,{className:"w-4 h-4"}),"Performance & Budget"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-budget",className:"text-xs",children:"Total Budget ($)"}),e.jsx(y,{id:"edit-budget",value:t.budget,onChange:s=>l({...t,budget:s.target.value}),placeholder:"e.g., 1000.00",className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-dailyBudget",className:"text-xs",children:"Daily Budget ($)"}),e.jsx(y,{id:"edit-dailyBudget",value:t.dailyBudget,onChange:s=>l({...t,dailyBudget:s.target.value}),placeholder:"e.g., 50.00",className:"text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-costPerClick",className:"text-xs",children:"Cost Per Click ($)"}),e.jsx(y,{id:"edit-costPerClick",value:t.costPerClick,onChange:s=>l({...t,costPerClick:s.target.value}),placeholder:"e.g., 0.50",className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-costPerImpression",className:"text-xs",children:"Cost Per Impression ($)"}),e.jsx(y,{id:"edit-costPerImpression",value:t.costPerImpression,onChange:s=>l({...t,costPerImpression:s.target.value}),placeholder:"e.g., 0.01",className:"text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-conversionGoal",className:"text-xs",children:"Conversion Goal"}),e.jsxs(_,{value:t.conversionGoal,onValueChange:s=>l({...t,conversionGoal:s}),children:[e.jsx(W,{id:"edit-conversionGoal",className:"text-sm",children:e.jsx(Y,{placeholder:"Select goal"})}),e.jsxs(Z,{children:[e.jsx(x,{value:"click",children:"Click"}),e.jsx(x,{value:"signup",children:"Sign Up"}),e.jsx(x,{value:"purchase",children:"Purchase"}),e.jsx(x,{value:"download",children:"Download"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-frequencyCap",className:"text-xs",children:"Frequency Cap (per user/day)"}),e.jsx(y,{id:"edit-frequencyCap",type:"number",value:t.frequencyCap||"",onChange:s=>l({...t,frequencyCap:parseInt(s.target.value)||0}),placeholder:"e.g., 3",className:"text-sm"})]})]})]}),e.jsx(X,{className:"my-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(es,{className:"w-4 h-4"}),"Metadata"]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-tags",className:"text-xs",children:"Tags (comma-separated)"}),e.jsx(y,{id:"edit-tags",value:t.tags.join(", "),onChange:s=>{const a=s.target.value.split(",").map(r=>r.trim()).filter(r=>r);l({...t,tags:a})},placeholder:"e.g., seasonal, promo, featured",className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-notes",className:"text-xs",children:"Internal Notes"}),e.jsx(be,{id:"edit-notes",value:t.notes,onChange:s=>l({...t,notes:s.target.value}),placeholder:"Add internal notes for this ad...",rows:3,className:"text-sm"})]})]}),e.jsx(X,{className:"my-4"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:"edit-isActive",checked:t.isActive,onCheckedChange:s=>l({...t,isActive:s})}),e.jsx(i,{htmlFor:"edit-isActive",className:"cursor-pointer",children:"Active (Display this ad)"})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsx(ts,{title:t.title,description:t.description,imageUrl:t.imageUrl,linkUrl:t.linkUrl,type:t.type,placement:t.placement})})]}),e.jsxs(Se,{children:[e.jsx(j,{variant:"outline",onClick:()=>B(!1),children:"Cancel"}),e.jsx(j,{onClick:gs,disabled:oe.isPending,children:oe.isPending?"Saving...":"Save Changes"})]})]})}),e.jsx(Je,{open:V!==null,onOpenChange:s=>!s&&K(null),children:e.jsxs(ze,{children:[e.jsxs(Ke,{children:[e.jsx(He,{children:"Are you sure?"}),e.jsx(Qe,{children:"This will permanently delete this advertisement. This action cannot be undone."})]}),e.jsxs(Xe,{children:[e.jsx(_e,{children:"Cancel"}),e.jsx(We,{onClick:js,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:xe.isPending?"Deleting...":"Delete"})]})]})}),e.jsx(Je,{open:ne,onOpenChange:H,children:e.jsxs(ze,{children:[e.jsxs(Ke,{children:[e.jsx(He,{children:"Delete Multiple Ads?"}),e.jsxs(Qe,{children:["This will permanently delete ",k.size," advertisement(s). This action cannot be undone."]})]}),e.jsxs(Xe,{children:[e.jsx(_e,{children:"Cancel"}),e.jsx(We,{onClick:()=>$e.mutate(Array.from(k)),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:$e.isPending?"Deleting...":`Delete ${k.size} Ad(s)`})]})]})}),e.jsx(ye,{open:se,onOpenChange:m,children:e.jsxs(we,{className:"max-w-2xl",children:[e.jsxs(ke,{children:[e.jsx(Ce,{children:"Import Advertisements"}),e.jsx(De,{children:"Upload a CSV or JSON file to bulk import advertisements"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"import-file",children:"Select File"}),e.jsx(y,{id:"import-file",type:"file",accept:".csv,.json",onChange:us,className:"mt-2"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Accepted formats: CSV, JSON"})]}),b&&e.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Selected file: ",b.name]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Size: ",(b.size/1024).toFixed(2)," KB"]})]}),U.length>0&&e.jsxs("div",{className:"mt-4 p-4 bg-destructive/10 border border-destructive/20 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-destructive mb-2",children:"Validation Errors"}),e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1",children:U.map((s,a)=>e.jsxs("p",{className:"text-sm text-destructive",children:["Row ",s.row,": ",s.field," - ",s.message]},a))})]}),e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:"CSV Format Example:"}),e.jsx("pre",{className:"text-xs overflow-x-auto p-2 bg-background rounded",children:`title,description,imageUrl,linkUrl,type,placement,isActive,displayOrder
"Sample Ad","Description","/uploads/ad.jpg","https://example.com","banner","homepage","true",1`}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"For array fields (targetCountries, tags, etc.), use pipe-delimited values: US|UK|CA"})]})]}),e.jsx(Se,{children:e.jsx(j,{variant:"outline",onClick:()=>{m(!1),D(null),p([])},children:"Close"})})]})})]})})}export{Bt as default};
