import{j as e}from"./ui-vendor-BpIggZZ9.js";import{u as b,b as x}from"./react-vendor-C7VPsBAG.js";import{u as j,P as N,b as y,N as h,a0 as g,C as u,B as p,$ as v,ai as w,F as P,K as k}from"./index-Bshoxa3b.js";import{P as S}from"./progress-BQnuNZzz.js";import{Z as f}from"./zap-CuepkoNH.js";import{P as C}from"./percent-I0-8Qg6_.js";import{S as T}from"./shopping-cart-1UVixAJg.js";import"./utils-vendor-BUCX3MvZ.js";function L({endTime:r}){const[c,o]=x.useState("");return x.useEffect(()=>{const n=()=>{const l=new Date(r).getTime(),d=new Date().getTime(),s=l-d;if(s<0){o("EXPIRED");return}const t=Math.floor(s/(1e3*60*60)),a=Math.floor(s%(1e3*60*60)/(1e3*60)),m=Math.floor(s%(1e3*60)/1e3);o(`${t}h ${a}m ${m}s`)};n();const i=setInterval(n,1e3);return()=>clearInterval(i)},[r]),e.jsxs("div",{className:"flex items-center gap-2 text-white",children:[e.jsx(k,{className:"w-5 h-5 text-red-500 animate-pulse"}),e.jsx("span",{className:"font-mono font-bold text-lg",children:c})]})}function D(){const[,r]=b(),{isAuthenticated:c,isLoading:o}=j(),{toast:n}=N(),{data:i,isLoading:l}=y({queryKey:["/api/flash-sales/active"],queryFn:async()=>{const s=await fetch("/api/flash-sales/active",{credentials:"include"});if(!s.ok)throw new Error("Failed to fetch flash sales");return s.json()},refetchInterval:3e4}),d=async s=>{if(!c){r("/login?returnTo=/flash-sales");return}try{const t=await fetch("/api/flash-sales/purchase",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"include",body:JSON.stringify({saleId:s})}),a=await t.json();if(!t.ok)throw new Error(a.message||"Failed to purchase");n({title:"Purchase Successful!",description:`${a.coinsReceived} coins added to your account`})}catch(t){n({title:"Purchase Failed",description:t.message,variant:"destructive"})}};return o||l?e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[e.jsx(h,{}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-20",children:[e.jsx(g,{className:"h-12 w-96 mx-auto mb-12 bg-gray-800"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[1,2].map(s=>e.jsx(g,{className:"h-64 bg-gray-800"},s))})]})]}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[e.jsx(h,{}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-16",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-red-500/10 border border-red-500/20 rounded-full mb-6 animate-pulse",children:[e.jsx(f,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"text-sm font-semibold text-red-500",children:"LIMITED TIME ONLY"})]}),e.jsx("h1",{className:"text-4xl sm:text-6xl font-bold text-white mb-4",children:"âš¡ Flash Sales"}),e.jsx("p",{className:"text-gray-400 text-lg max-w-2xl mx-auto",children:"Grab exclusive deals before they're gone! Limited quantity and time offers"})]}),!i||i.length===0?e.jsxs(u,{className:"bg-gray-900/50 border-gray-800 text-center p-16",children:[e.jsx(f,{className:"w-16 h-16 mx-auto mb-4 text-gray-600"}),e.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"No Active Flash Sales"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Check back soon for amazing deals!"}),e.jsx(p,{onClick:()=>r("/shop"),variant:"outline",className:"border-primary/40 hover:bg-primary/10",children:"Browse Regular Shop"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:i.map(s=>{const t=s.maxPurchases-s.currentPurchases,a=t/s.maxPurchases*100,m=s.currencyAmount+Math.floor(s.currencyAmount*s.bonusPercentage/100);return e.jsxs(u,{className:"relative overflow-hidden bg-gradient-to-br from-red-500/10 to-orange-500/10 border-red-500/30 hover:border-red-500/50 transition-all duration-300",children:[e.jsxs("div",{className:"absolute top-0 right-0 bg-gradient-to-r from-red-500 to-orange-500 text-white text-xs font-bold px-4 py-1.5 rounded-bl-xl",children:[s.discountPercent,"% OFF"]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:s.packageName}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-5 h-5 text-orange-500"}),e.jsxs("span",{className:"text-xl font-semibold text-white",children:[m.toLocaleString()," Coins"]})]})]})}),e.jsx("div",{className:"bg-black/30 rounded-lg p-4 border border-gray-700",children:e.jsx(L,{endTime:s.endTime})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Stock Remaining"}),e.jsxs("span",{className:"text-white font-semibold",children:[t,"/",s.maxPurchases]})]}),e.jsx(S,{value:a,className:w("h-2",a<20?"bg-red-900":"bg-gray-700")}),a<20&&e.jsx("p",{className:"text-xs text-red-400 font-semibold animate-pulse",children:"Almost sold out!"})]}),e.jsxs("div",{className:"flex items-end gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Was"}),e.jsxs("p",{className:"text-gray-500 line-through text-lg",children:["$",s.originalPrice]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Now"}),e.jsxs("p",{className:"text-3xl font-bold text-white",children:["$",s.salePrice]})]})]}),s.bonusPercentage>0&&e.jsxs("div",{className:"bg-primary/10 border border-primary/20 rounded-lg p-3 flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4 text-primary"}),e.jsxs("span",{className:"text-sm text-primary font-semibold",children:["+",s.bonusPercentage,"% Bonus Coins Included!"]})]}),e.jsxs(p,{onClick:()=>d(s.id),disabled:t<=0,className:"w-full bg-gradient-to-r from-red-500 to-orange-500 hover:from-red-600 hover:to-orange-600 text-white shadow-lg shadow-red-500/25",size:"lg",children:[e.jsx(T,{className:"w-5 h-5 mr-2"}),t<=0?"Sold Out":"Grab This Deal"]})]})]},s.id)})})]}),e.jsx(P,{})]})}export{D as default};
