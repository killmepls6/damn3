import{j as e}from"./ui-vendor-BpIggZZ9.js";import{b as t,u as Na,L as ba}from"./react-vendor-C7VPsBAG.js";import{c as be,ab as Ds,p as se,B as n,ac as ya,t as r,aa as ee,l as Ne,K as Ca,ad as Us,L as Ve,ae as ka,u as Sa,m as u,I as T,Y as Pa,af as ie,T as je,e as Xe,a8 as Da,C as Ge,i as Je,a9 as Ua,f as Fa,g as Ea,h as Ta,a3 as za,a5 as _}from"./index-Bshoxa3b.js";import{S as Ke,a as Qe,b as _e,c as es,d as Le}from"./select-DT_5i3rD.js";import{D as H,a as W,b as Z,c as Y,d as le,e as Fs,f as ss}from"./dialog-B4soTW2z.js";import{A as as,a as ts,b as rs,c as is,d as ls,e as ns,f as cs,g as ds}from"./alert-dialog-ckVHmtNn.js";import{C as Es}from"./circle-check-big-BOxg75CQ.js";import{E as $e}from"./eye-QF1-RHmE.js";import{P as Aa}from"./progress-BQnuNZzz.js";import{S as Ts}from"./square-check-big-DgO1Q1Lh.js";import{S as zs}from"./square-Br1AVrZR.js";import{E as Ma}from"./eye-off-5pfH6nJe.js";import{C as La}from"./calendar-ByILsbL3.js";import{S as Re}from"./square-pen-C7u-hRzu.js";import{I as As}from"./image-DlU6CFoZ.js";import{S as we}from"./save-B39N0M5_.js";import{P as Ra}from"./plus-CIXQeA2Y.js";import"./utils-vendor-BUCX3MvZ.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=be("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=be("FileArchive",[["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01",key:"gkbcor"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=be("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=be("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=be("MousePointer2",[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]]);function Oa({isOpen:S,onClose:k,onConfirm:U,initialPages:A,chapterNumber:$,naturalSortConfidence:l,requiresManualReorder:V,chapterTitle:M}){const[N,d]=t.useState(A),[F,o]=t.useState(null),[z,E]=t.useState(-1),[I,q]=t.useState(!1),[m,f]=t.useState(null);t.useEffect(()=>{S&&(d(A),q(!1),o(null),E(-1),f(null))},[S,A]);const ne=(c,p)=>{const w={index:p,page:N[p]};o(w),c.dataTransfer.effectAllowed="move",c.dataTransfer.setData("text/plain",JSON.stringify(w)),c.currentTarget.style.opacity="0.5"},X=c=>{c.currentTarget.style.opacity="1",o(null),E(-1)},ce=(c,p)=>{c.preventDefault(),c.dataTransfer.dropEffect="move",E(p)},ae=c=>{c.currentTarget.contains(c.relatedTarget)||E(-1)},ue=(c,p)=>{if(c.preventDefault(),!F)return;const w=F.index;if(w===p){E(-1);return}const D=[...N],[pe]=D.splice(w,1);D.splice(p,0,pe),d(D),q(!0),E(-1),r({title:"Page Reordered",description:`Moved page ${w+1} to position ${p+1}`})},G=()=>{d(A),q(!1),r({title:"Order Reset",description:"Pages have been reset to original order"})},J=()=>{U(N),k()},P=c=>c>=.8?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":c>=.6?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",Ie=c=>c>=.8?"High Confidence":c>=.6?"Medium Confidence":"Low Confidence";return e.jsxs(e.Fragment,{children:[e.jsx(H,{open:S,onOpenChange:k,children:e.jsxs(W,{className:"max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs(Z,{children:[e.jsxs(Y,{className:"flex items-center gap-2",children:[V?e.jsx(Ds,{className:"w-5 h-5 text-amber-500"}):e.jsx(Es,{className:"w-5 h-5 text-green-500"}),"Page Order Review - Chapter ",$,M&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",M,")"]})]}),e.jsxs(le,{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{children:"Natural sorting confidence:"}),e.jsxs(se,{className:P(l),children:[Ie(l)," (",Math.round(l*100),"%)"]})]}),V?e.jsxs("div",{className:"flex items-center gap-2 text-amber-600",children:[e.jsx(Ds,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"The automatic page ordering may not be correct. Please review and reorder if needed."})]}):e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsx(Es,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Page order looks good! You can still reorder pages if needed."})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ba,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Drag and drop pages to reorder them. Click on a page to preview it."})]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-6 gap-4 p-2",children:N.map((c,p)=>e.jsxs("div",{draggable:!0,onDragStart:w=>ne(w,p),onDragEnd:X,onDragOver:w=>ce(w,p),onDragLeave:ae,onDrop:w=>ue(w,p),className:`
                      relative group cursor-move border-2 rounded-lg overflow-hidden
                      transition-all duration-200 hover:shadow-lg
                      ${z===p?"border-primary bg-primary/10 scale-105":"border-border hover:border-primary/50"}
                      ${F?.index===p?"opacity-50":""}
                    `,children:[e.jsx("div",{className:"absolute top-2 left-2 z-10",children:e.jsx(se,{variant:"secondary",className:"text-xs font-bold bg-black/70 text-white",children:p+1})}),e.jsx("div",{className:"absolute top-2 right-2 z-10 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"bg-black/70 rounded p-1",children:e.jsx(qa,{className:"w-4 h-4 text-white"})})}),e.jsxs("div",{className:"aspect-[3/4] bg-gray-100 dark:bg-gray-800 relative cursor-pointer",onClick:()=>f(c),children:[e.jsx("img",{src:c,alt:`Page ${p+1}`,className:"w-full h-full object-cover",onError:w=>{w.target.style.display="none";const D=w.target.parentElement;D&&(D.innerHTML='<div class="flex items-center justify-center h-full text-muted-foreground"><span>Failed to load</span></div>')}}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100",children:e.jsx(n,{size:"sm",variant:"secondary",className:"pointer-events-none",children:e.jsx($e,{className:"w-4 h-4"})})})]}),z===p&&F&&F.index!==p&&e.jsx("div",{className:"absolute inset-0 border-2 border-primary border-dashed bg-primary/20 rounded-lg flex items-center justify-center",children:e.jsx($a,{className:"w-6 h-6 text-primary"})})]},`${c}-${p}`))})})}),e.jsxs(Fs,{className:"flex-row justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(n,{variant:"outline",onClick:G,disabled:!I,className:"flex items-center gap-2",children:[e.jsx(ya,{className:"w-4 h-4"}),"Reset Order"]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[N.length," pages total"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{variant:"outline",onClick:k,children:"Cancel"}),e.jsx(n,{onClick:J,className:"min-w-20",children:I?"Save Changes":"Confirm Order"})]})]})]})}),m&&e.jsx(H,{open:!!m,onOpenChange:()=>f(null),children:e.jsxs(W,{className:"max-w-3xl",children:[e.jsx(Z,{children:e.jsx(Y,{children:"Page Preview"})}),e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:m,alt:"Page preview",className:"max-h-[70vh] max-w-full object-contain",onError:c=>{r({title:"Error",description:"Failed to load page preview",variant:"destructive"}),f(null)}})}),e.jsx(Fs,{children:e.jsx(n,{onClick:()=>f(null),children:"Close"})})]})})]})}function Ha({open:S,onOpenChange:k,uploadId:U,onComplete:A,onError:$}){const[l,V]=t.useState(null),[M,N]=t.useState(!1),d=t.useRef(null),F=t.useCallback(m=>{if(m===0)return"0 B";const f=1024,ne=["B","KB","MB","GB"],X=Math.floor(Math.log(m)/Math.log(f));return`${parseFloat((m/Math.pow(f,X)).toFixed(1))} ${ne[X]}`},[]),o=t.useCallback(m=>m<60?`${Math.round(m)}s`:m<3600?`${Math.round(m/60)}m`:`${Math.round(m/3600)}h`,[]),z=t.useCallback(async()=>{if(!(!U||!S))try{const m=await fetch(`/api/admin/upload-progress/${U}`,{headers:{"X-Requested-With":"XMLHttpRequest"}});if(m.ok){const f=await m.json();V(f),f.status==="complete"?(N(!1),d.current&&(clearInterval(d.current),d.current=null),setTimeout(()=>{A?.(),k(!1)},2e3)):f.status==="error"&&(N(!1),d.current&&(clearInterval(d.current),d.current=null),$?.(f.error||"Upload failed"))}else m.status===404&&(N(!1),d.current&&(clearInterval(d.current),d.current=null),$?.("Upload session expired"))}catch{}},[U,S,A,$,k]);t.useEffect(()=>{if(d.current&&(clearInterval(d.current),d.current=null,N(!1)),U&&S)return N(!0),V(null),z(),d.current=setInterval(z,500),()=>{d.current&&(clearInterval(d.current),d.current=null),N(!1)}},[U,S]),t.useEffect(()=>()=>{d.current&&(clearInterval(d.current),d.current=null)},[]);const E=async()=>{if(U)try{const m=await fetch(`/api/admin/upload-cancel/${U}`,{method:"DELETE",headers:{"X-Requested-With":"XMLHttpRequest"}});if(m.ok)N(!1),d.current&&(clearInterval(d.current),d.current=null),k(!1);else{const f=await m.json();N(!1),d.current&&(clearInterval(d.current),d.current=null),k(!1),$?.(f.message||"Failed to cancel upload")}}catch{N(!1),d.current&&(clearInterval(d.current),d.current=null),k(!1),$?.("Network error while cancelling upload")}},I=()=>{if(!l)return e.jsx(Ve,{className:"h-4 w-4 animate-spin"});switch(l.status){case"initializing":case"uploading":return e.jsx(Ne,{className:"h-4 w-4"});case"processing":case"extracting":return e.jsx(Ia,{className:"h-4 w-4"});case"finalizing":return e.jsx(Ve,{className:"h-4 w-4 animate-spin"});case"complete":return e.jsx(Us,{className:"h-4 w-4 text-green-600"});case"error":return e.jsx(ka,{className:"h-4 w-4 text-red-600"});default:return e.jsx(Ve,{className:"h-4 w-4 animate-spin"})}},q=()=>{if(!l)return"bg-blue-100 text-blue-800";switch(l.status){case"complete":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"error":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";default:return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300"}};return e.jsx(H,{open:S,onOpenChange:k,children:e.jsxs(W,{className:"sm:max-w-md",onPointerDownOutside:m=>m.preventDefault(),children:[e.jsx(Z,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[I(),"Upload Progress"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(se,{className:q(),children:l?.status?l.status.charAt(0).toUpperCase()+l.status.slice(1):"Initializing"}),l&&l.status!=="complete"&&l.status!=="error"&&e.jsx(n,{variant:"ghost",size:"sm",onClick:E,className:"h-auto p-1",children:e.jsx(ee,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm font-medium",children:[l?.progress||0,"%"]}),l?.totalFiles&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[l.processedFiles||0," / ",l.totalFiles," files"]})]}),e.jsx(Aa,{value:l?.progress||0,className:"w-full"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l?.message||"Initializing upload..."}),l?.currentFile&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Processing:"})," ",l.currentFile]}),l&&(l.speed||l.estimatedTimeRemaining)&&e.jsxs("div",{className:"flex gap-4 text-xs text-muted-foreground",children:[l.speed&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ne,{className:"h-3 w-3"}),e.jsxs("span",{children:[l.speed.toFixed(1)," MB/s"]})]}),l.estimatedTimeRemaining&&l.estimatedTimeRemaining>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ca,{className:"h-3 w-3"}),e.jsxs("span",{children:[o(l.estimatedTimeRemaining)," remaining"]})]})]}),l?.details&&e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[l.details.uploadedBytes&&l.details.totalBytes&&e.jsxs("div",{children:[F(l.details.uploadedBytes)," / ",F(l.details.totalBytes)]}),l.details.filesExtracted&&e.jsxs("div",{children:[l.details.filesExtracted," images extracted"]})]}),l?.error&&e.jsx("div",{className:"text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-950/50 p-2 rounded",children:l.error}),l?.status==="complete"&&e.jsxs("div",{className:"text-sm text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-950/50 p-2 rounded flex items-center gap-2",children:[e.jsx(Us,{className:"h-4 w-4"}),"Chapter uploaded successfully!"]})]})]})})}const Ls=[{value:"ongoing",label:"Ongoing",color:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300"},{value:"completed",label:"Completed",color:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"},{value:"hiatus",label:"Hiatus",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300"},{value:"cancelled",label:"Cancelled",color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"}],Wa=[{value:"manga",label:"Manga"},{value:"manhwa",label:"Manhwa"},{value:"manhua",label:"Manhua"},{value:"webtoon",label:"Webtoon"}],Za=["Action","Adventure","Comedy","Drama","Fantasy","Horror","Mystery","Romance","Sci-Fi","Slice of Life","Sports","Supernatural","Thriller","Historical","Psychological","School","Martial Arts","Mecha","Military","Music"];function ot(){const{isAdmin:S,isAuthenticated:k}=Sa(),[,U]=Na(),[A,$]=t.useState([]),[l,V]=t.useState(!0),[M,N]=t.useState(""),[d,F]=t.useState(!1),[o,z]=t.useState(null),[E,I]=t.useState(null),[q,m]=t.useState(null),[f,ne]=t.useState(!1),[X,ce]=t.useState(null),[ae,ue]=t.useState("url"),G=t.useRef(null),J=t.useRef(null),[P,Ie]=t.useState([]),[c,p]=t.useState(!1),[w,D]=t.useState(""),[pe,qe]=t.useState(0),[xe,ye]=t.useState(!1),[os,Be]=t.useState(""),[Rs,Ce]=t.useState(!1),[$s,Oe]=t.useState(null),[Is,ke]=t.useState(!1),[K,qs]=t.useState(null),[ms,Bs]=t.useState([]),[Os,hs]=t.useState(!1),[Q,Se]=t.useState(""),[Pe,He]=t.useState(""),[ge,We]=t.useState(!1),[v,te]=t.useState(new Set),[B,De]=t.useState(null),[Hs,Ue]=t.useState(!1),[Ws,Fe]=t.useState(!1),[Zs,us]=t.useState(new Set),[Ee,Ze]=t.useState(null),[Te,ze]=t.useState(null),[ps,xs]=t.useState(!1),[de,oe]=t.useState(null),O=t.useRef(null),[Ys,gs]=t.useState(!1),[L,fs]=t.useState(null),[g,fe]=t.useState({title:"",description:"",author:"",artist:"",status:"ongoing",type:"manga",genres:[],coverImageUrl:"",rating:void 0,publishedYear:void 0,isAdult:"false",isFeatured:"false",isTrending:"false",isPopularToday:"false",isLatestUpdate:"false",isPinned:"false"}),Vs=s=>{if(!s||s.trim()==="")return;const a=parseInt(s,10);return isNaN(a)?void 0:a},Xs=s=>{if(!s||s.trim()==="")return;const a=parseFloat(s);return isNaN(a)?void 0:a};t.useEffect(()=>{if(!k||!S){U("/login");return}Ae(),Gs()},[k,S,U]);const Gs=async()=>{try{const s=await fetch("/api/admin/upload-config",{headers:{"X-Requested-With":"XMLHttpRequest"}});if(s.ok){const a=await s.json();Ze(a)}else Ze({maxZipSizeMB:200,maxZipSizeBytes:200*1024*1024,maxArchiveFiles:200,maxFileSize:10*1024*1024,allowedExtensions:[".jpg",".jpeg",".png",".webp",".gif"]})}catch{Ze({maxZipSizeMB:200,maxZipSizeBytes:200*1024*1024,maxArchiveFiles:200,maxFileSize:10*1024*1024,allowedExtensions:[".jpg",".jpeg",".png",".webp",".gif"]})}};t.useEffect(()=>{te(new Set),us(new Set)},[o?.id]);const Ae=async()=>{try{V(!0);const s=await fetch("/api/admin/series");if(s.ok){const a=await s.json();$(a)}}catch{r({title:"Error",description:"Failed to fetch series data",variant:"destructive"})}finally{V(!1)}},R=async s=>{try{const a=await fetch(`/api/admin/chapters?seriesId=${s}`);if(a.ok){const h=(await a.json()).map(x=>{const j={...x};if(x.coverImageUrl&&!x.coverImageUrl.startsWith("http")&&!x.coverImageUrl.startsWith("/api/")){const C=x.coverImageUrl.startsWith("chapters/")?x.coverImageUrl.substring(9):x.coverImageUrl;j.coverImageUrl=`/api/chapters/image/${C}`}return j});Ie(h)}}catch{r({title:"Error",description:"Failed to fetch chapters",variant:"destructive"})}},y=(s,a)=>{fe(i=>({...i,[s]:a}))},me=()=>{fe({title:"",description:"",author:"",artist:"",status:"ongoing",type:"manga",genres:[],coverImageUrl:"",rating:void 0,publishedYear:void 0,isAdult:"false",isFeatured:"false",isTrending:"false",isPopularToday:"false",isLatestUpdate:"false"}),z(null),ce(null),ue("url"),G.current&&(G.current.value="")},Js=s=>{s.preventDefault(),We(!0)},Ks=s=>{s.preventDefault(),We(!1)},Qs=s=>{s.preventDefault(),We(!1);const i=Array.from(s.dataTransfer.files).find(h=>h.name.toLowerCase().endsWith(".zip"));i?vs(i):r({title:"Error",description:"Please drop a ZIP file containing chapter images",variant:"destructive"})},vs=async s=>{if(!Q.trim()){r({title:"Error",description:"Please enter a chapter number first",variant:"destructive"});return}const a=parseFloat(Q.trim());if(isNaN(a)||a<=0){r({title:"Error",description:"Chapter number must be a valid positive number (e.g., 1, 1.5, 2)",variant:"destructive"});return}if(!s.name.toLowerCase().endsWith(".zip")){r({title:"Error",description:"Please upload a ZIP file containing chapter images",variant:"destructive"});return}if(!Ee){r({title:"Error",description:"Upload configuration not loaded. Please try again.",variant:"destructive"});return}if(s.size>Ee.maxZipSizeBytes){r({title:"Error",description:`Chapter ZIP file must be less than ${Ee.maxZipSizeMB}MB`,variant:"destructive"});return}if(!o?.id){r({title:"Error",description:"Please save the series first before uploading chapters",variant:"destructive"});return}try{p(!0),ye(!0),D("Validating file and preparing upload..."),qe(0),Be("");const i=await fetch("/api/csrf-token",{credentials:"include"}),{csrfToken:h}=await i.json(),x=new FormData;x.append("zip",s),x.append("seriesId",o.id),x.append("chapterNumber",Q.trim()),Pe.trim()&&x.append("title",Pe.trim());const j=await new Promise((ve,re)=>{const b=new XMLHttpRequest;b.upload.onloadstart=()=>{ye(!1),D("Uploading file to server...")},b.upload.onprogress=he=>{if(he.lengthComputable){const Me=Math.round(he.loaded/he.total*100);qe(Me),D(`Uploading... ${Me}%`)}},b.onload=()=>{ye(!1),ve(new Response(b.responseText,{status:b.status,statusText:b.statusText,headers:b.getAllResponseHeaders().split(`\r
`).reduce((he,Me)=>{const[Ss,Ps]=Me.split(": ");return Ss&&Ps&&(he[Ss]=Ps),he},{})}))},b.onerror=()=>re(new Error("Network error")),b.ontimeout=()=>re(new Error("Upload timeout")),b.open("POST","/api/admin/upload-chapter"),b.setRequestHeader("X-Requested-With","XMLHttpRequest"),b.setRequestHeader("x-csrf-token",h),b.send(x)}),C=await j.json();if(j.status===202)if(C.uploadId)Be(C.uploadId),Oe(C.uploadId),Ce(!0),r({title:"Upload Started",description:`Chapter ${Q} upload started. Processing in background...`}),J.current&&(J.current.value=""),Se(""),He("");else throw new Error("No upload ID returned from server");else if(j.ok)r({title:"Error",description:"Unexpected server response format. Please try again.",variant:"destructive"});else{const ve=C.message||"Failed to upload chapter",re=C.requestId||C.uploadId?` (ID: ${C.requestId||C.uploadId})`:"";r({title:"Upload Failed",description:`${ve}${re}`,variant:"destructive"})}}catch{const h=os?` (Request ID: ${os})`:"";r({title:"Upload Error",description:`Network error or server unavailable. Please check your connection and try again.${h}`,variant:"destructive"})}finally{p(!1),ye(!1),D(""),qe(0),Be("")}},_s=async s=>{const a=s.target.files?.[0];a&&vs(a)},ea=async s=>{if(L)try{const a=await _("PUT",`/api/admin/chapters/${L.chapter.id}`,{pages:s,requiresManualReorder:"false",naturalSortConfidence:"1.0"});r({title:"Success",description:`Chapter ${L.chapter.chapterNumber} page order updated successfully!`}),o?.id&&await R(o.id)}catch(a){r({title:"Error",description:a?.message||"Failed to update page order. Please try again.",variant:"destructive"})}finally{fs(null),gs(!1),o?.id&&await R(o.id)}},sa=async()=>{Ce(!1),Oe(null),p(!1),D(""),o?.id&&await R(o.id),J.current&&(J.current.value=""),Se(""),He(""),r({title:"Upload Complete",description:"Chapter has been uploaded successfully!"})},aa=s=>{Ce(!1),Oe(null),p(!1),D(""),r({title:"Upload Failed",description:s,variant:"destructive"})},ta=async()=>{L&&o?.id&&await R(o.id),fs(null),gs(!1)},ra=async s=>{try{await _("DELETE",`/api/admin/chapters/${s}`),r({title:"Success",description:"Chapter deleted successfully"}),o?.id&&await R(o.id),te(a=>{const i=new Set(a);return i.delete(s),i})}catch(a){r({title:"Error",description:a?.message||"Failed to delete chapter. Please try again.",variant:"destructive"})}},js=s=>{De(s),Ue(!0)},ia=async()=>{if(B)try{await _("PATCH",`/api/admin/chapters/${B.id}`,{title:B.title||"",isPublished:B.isPublished}),r({title:"Success",description:"Chapter updated successfully"}),o?.id&&await R(o.id),Ue(!1),De(null)}catch(s){r({title:"Error",description:s?.message||"Failed to update chapter. Please try again.",variant:"destructive"})}},la=s=>{const a=new Set(v);a.has(s)?a.delete(s):a.add(s),te(a)},na=()=>{v.size===P.length?te(new Set):te(new Set(P.map(s=>s.id)))},ca=s=>{us(a=>new Set([...Array.from(a),s]))},da=s=>{ze(s),oe(s.coverImageUrl)},oa=s=>{const a=s.target.files?.[0];if(a){if(a.size>5*1024*1024){r({title:"Error",description:"Cover image must be less than 5MB",variant:"destructive"});return}const i=new FileReader;i.onload=h=>{const x=h.target?.result;oe(x)},i.readAsDataURL(a)}},ma=async()=>{if(!(!Te||!de))try{xs(!0);const s=await fetch("/api/csrf-token",{credentials:"include"}),{csrfToken:a}=await s.json(),i=new FormData;O.current?.files?.[0]?i.append("coverImage",O.current.files[0]):de.startsWith("http")&&i.append("coverImageUrl",de);const h=await fetch(`/api/admin/chapters/${Te.id}/cover`,{method:"PATCH",headers:{"X-Requested-With":"XMLHttpRequest","x-csrf-token":a},body:i,credentials:"include"});if(h.ok)r({title:"Success",description:"Chapter cover updated successfully"}),o?.id&&await R(o.id),ze(null),oe(null),O.current&&(O.current.value="");else{const x=await h.json();r({title:"Error",description:x.message||"Failed to update chapter cover",variant:"destructive"})}}catch(s){r({title:"Error",description:s?.message||"Failed to update chapter cover. Please try again.",variant:"destructive"})}finally{xs(!1)}},ha=async s=>{try{hs(!0),qs(s),ke(!0);const a=await fetch(`/api/admin/chapters/${s.id}`);if(a.ok){const x=((await a.json()).pages||[]).map(j=>j.startsWith("http://")||j.startsWith("https://")||j.startsWith("/api/")?j:`/api/chapters/image/${j.startsWith("chapters/")?j.substring(9):j}`);Bs(x.slice(0,5))}else throw new Error("Failed to fetch chapter data")}catch{r({title:"Preview Error",description:"Failed to load chapter preview. Please try again.",variant:"destructive"}),ke(!1)}finally{hs(!1)}},ws=async s=>{if(v.size!==0)try{const a=Array.from(v).map(i=>_("PATCH",`/api/admin/chapters/${i}`,{isPublished:s}));await Promise.all(a),r({title:"Success",description:`${v.size} chapters ${s?"published":"unpublished"} successfully`}),o?.id&&await R(o.id),te(new Set)}catch(a){r({title:"Error",description:a?.message||"Failed to update chapters. Please try again.",variant:"destructive"})}},ua=async()=>{if(v.size!==0)try{const s=Array.from(v).map(a=>_("DELETE",`/api/admin/chapters/${a}`));await Promise.all(s),r({title:"Success",description:`${v.size} chapters deleted successfully`}),o?.id&&await R(o.id),te(new Set),Fe(!1)}catch(s){r({title:"Error",description:s?.message||"Failed to delete chapters. Please try again.",variant:"destructive"}),Fe(!1)}},Ns=s=>{if(!s)return"Unknown";try{return new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid date"}},pa=(s,a)=>{fe(i=>{const h=i.genres||[];return a===!0?{...i,genres:h.includes(s)?h:[...h,s]}:{...i,genres:h.filter(j=>j!==s)}})},bs=s=>{const a={...s};return Object.keys(a).forEach(i=>{const h=a[i];h===""&&!Array.isArray(h)&&(a[i]=void 0)}),a.genres||(a.genres=[]),a.isAdult=a.isAdult!==void 0?a.isAdult:"false",a.isFeatured=a.isFeatured!==void 0?a.isFeatured:"false",a.isTrending=a.isTrending!==void 0?a.isTrending:"false",a.isPopularToday=a.isPopularToday!==void 0?a.isPopularToday:"false",a.isLatestUpdate=a.isLatestUpdate!==void 0?a.isLatestUpdate:"false",a},xa=async()=>{if(!g.title?.trim()){r({title:"Error",description:"Title is required",variant:"destructive"});return}try{const s=bs(g),i=await(await _("POST","/api/admin/series",s)).json();r({title:"Success",description:"Series added successfully"}),await Ae(),F(!1),me()}catch(s){r({title:"Error",description:s?.message||"Failed to add series. Please try again.",variant:"destructive"})}},ys=async s=>{z(s),fe({title:s.title,description:s.description||"",author:s.author||"",artist:s.artist||"",status:s.status,type:s.type,genres:s.genres||[],coverImageUrl:s.coverImageUrl||"",rating:s.rating,publishedYear:s.publishedYear,isAdult:s.isAdult||"false",isFeatured:s.isFeatured||"false",isTrending:s.isTrending||"false",isPopularToday:s.isPopularToday||"false",isLatestUpdate:s.isLatestUpdate||"false"}),s.coverImageUrl&&ce(s.coverImageUrl),await R(s.id)},Cs=async()=>{if(!o?.id||!g.title?.trim()){r({title:"Error",description:"Title is required",variant:"destructive"});return}try{const s=bs(g),i=await(await _("PUT",`/api/admin/series/${o.id}`,s)).json();r({title:"Success",description:"Series updated successfully"}),await Ae(),z(null),me()}catch(s){r({title:"Error",description:s?.message||"Failed to update series. Please try again.",variant:"destructive"})}},ga=async s=>{try{await _("DELETE",`/api/admin/series/${s}`),r({title:"Success",description:"Series deleted successfully"}),await Ae(),I(null)}catch(a){r({title:"Error",description:a?.message||"Failed to delete series. Please try again.",variant:"destructive"})}},fa=async s=>{const a=s.target.files?.[0];if(!a)return;if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(a.type.toLowerCase())){r({title:"Error",description:"Please upload a valid image file (JPEG, PNG, or WebP)",variant:"destructive"});return}if(a.size>5*1024*1024){r({title:"Error",description:"Image must be less than 5MB",variant:"destructive"});return}try{ne(!0);const h=await fetch("/api/csrf-token",{credentials:"include"}),{csrfToken:x}=await h.json(),j=new FormData;j.append("image",a);const C=await fetch("/api/admin/upload-cover",{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest","x-csrf-token":x},body:j,credentials:"include"});if(!C.ok){const b=await C.json();throw new Error(b.message||"Upload failed")}const re=(await C.json()).url;fe(b=>({...b,coverImageUrl:re})),ce(re),r({title:"Success",description:"Image uploaded successfully"})}catch(h){r({title:"Error",description:h?.message||"Failed to upload image. Please try again.",variant:"destructive"})}finally{ne(!1)}},va=s=>{const a=Ls.find(i=>i.value===s);return e.jsx(se,{variant:"secondary",className:a?.color,children:a?.label||s})},ks=A.filter(s=>s.title.toLowerCase().includes(M.toLowerCase())||s.author?.toLowerCase().includes(M.toLowerCase())||s.type.toLowerCase().includes(M.toLowerCase())||s.genres?.some(a=>a.toLowerCase().includes(M.toLowerCase())));if(!k||!S)return null;const Ye=t.useMemo(()=>e.jsxs("div",{className:"grid gap-4 py-4 w-full min-w-0",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"title",children:"Title *"}),e.jsx(T,{id:"title",value:g.title||"",onChange:s=>y("title",s.target.value),className:"bg-background/50 w-full",autoComplete:"off"})]}),e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"author",children:"Author"}),e.jsx(T,{id:"author",value:g.author||"",onChange:s=>y("author",s.target.value),className:"bg-background/50 w-full",autoComplete:"off"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"type",children:"Type"}),e.jsxs(Ke,{value:g.type,onValueChange:s=>y("type",s),children:[e.jsx(Qe,{className:"bg-background/50 w-full",children:e.jsx(_e,{placeholder:"Select type"})}),e.jsx(es,{children:Wa.map(s=>e.jsx(Le,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"status",children:"Status"}),e.jsxs(Ke,{value:g.status,onValueChange:s=>y("status",s),children:[e.jsx(Qe,{className:"bg-background/50 w-full",children:e.jsx(_e,{placeholder:"Select status"})}),e.jsx(es,{children:Ls.map(s=>e.jsx(Le,{value:s.value,children:s.label},s.value))})]})]})]}),e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"description",children:"Description"}),e.jsx(Pa,{id:"description",value:g.description||"",onChange:s=>y("description",s.target.value),className:"bg-background/50 w-full resize-none",rows:3,autoComplete:"off"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"artist",children:"Artist"}),e.jsx(T,{id:"artist",value:g.artist||"",onChange:s=>y("artist",s.target.value),className:"bg-background/50 w-full"})]}),e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"publishedYear",children:"Published Year"}),e.jsx(T,{id:"publishedYear",type:"number",min:"1900",max:new Date().getFullYear()+5,value:g.publishedYear!=null?g.publishedYear.toString():"",onChange:s=>y("publishedYear",Vs(s.target.value)),className:"bg-background/50 w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"rating",children:"Rating (0-10)"}),e.jsx(T,{id:"rating",type:"number",min:"0",max:"10",step:"0.1",value:g.rating!=null?g.rating.toString():"",onChange:s=>y("rating",Xs(s.target.value)),className:"bg-background/50 w-full"})]}),e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"coverUrl",children:"Cover Image URL"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(T,{id:"coverUrl",value:g.coverImageUrl||"",onChange:s=>y("coverImageUrl",s.target.value),className:"bg-background/50 w-full",placeholder:"https://example.com/cover.jpg",disabled:ae==="file"}),e.jsx(n,{type:"button",variant:"outline",size:"sm",onClick:()=>ue(ae==="url"?"file":"url"),className:"whitespace-nowrap flex-shrink-0",children:ae==="url"?"Upload File":"Use URL"})]})]})]}),ae==="file"&&e.jsx("div",{className:"space-y-4 border-t pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Cover Image Upload"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{ref:G,type:"file",accept:"image/*",onChange:fa,className:"hidden"}),e.jsx(n,{type:"button",variant:"outline",onClick:()=>G.current?.click(),disabled:f,className:"bg-background/50 hover:bg-background/70",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-primary border-t-transparent rounded-full mr-2"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Choose Image"]})}),X&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("img",{src:X,alt:"Preview",className:"h-16 w-12 object-cover rounded border max-w-full"}),e.jsx(n,{type:"button",variant:"ghost",size:"sm",onClick:()=>{y("coverImageUrl",""),ce(null),ue("url"),G.current&&(G.current.value="")},children:e.jsx(ee,{className:"w-4 h-4"})})]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Genres"}),e.jsx("div",{className:"grid grid-cols-1 xs:grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2 max-h-32 overflow-y-scroll p-2 border rounded [&::-webkit-scrollbar]:hidden",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:Za.map(s=>e.jsxs("div",{className:"flex items-center justify-between space-x-2 min-w-0",children:[e.jsx(u,{htmlFor:s,className:"text-sm truncate cursor-pointer",children:s}),e.jsx(ie,{id:s,checked:g.genres?.includes(s)||!1,onCheckedChange:a=>pa(s,a),className:"flex-shrink-0"})]},s))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Content Settings"}),e.jsxs("div",{className:"flex items-center justify-between space-x-2",children:[e.jsx(u,{htmlFor:"isAdult",className:"text-sm font-medium cursor-pointer",children:"Adult Content (18+)"}),e.jsx(ie,{id:"isAdult",checked:g.isAdult==="true",onCheckedChange:s=>{y("isAdult",s===!0?"true":"false")}})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{children:"Homepage Sections"}),e.jsxs("div",{className:"grid grid-cols-1 xs:grid-cols-2 sm:grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between space-x-2 min-w-0",children:[e.jsx(u,{htmlFor:"isFeatured",className:"text-sm font-medium truncate cursor-pointer",children:"Featured"}),e.jsx(ie,{id:"isFeatured",checked:g.isFeatured==="true",onCheckedChange:s=>{y("isFeatured",s===!0?"true":"false")},className:"flex-shrink-0"})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 min-w-0",children:[e.jsx(u,{htmlFor:"isTrending",className:"text-sm font-medium truncate cursor-pointer",children:"Trending"}),e.jsx(ie,{id:"isTrending",checked:g.isTrending==="true",onCheckedChange:s=>{y("isTrending",s===!0?"true":"false")},className:"flex-shrink-0"})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 min-w-0",children:[e.jsx(u,{htmlFor:"isPopularToday",className:"text-sm font-medium truncate cursor-pointer",children:"Popular Today"}),e.jsx(ie,{id:"isPopularToday",checked:g.isPopularToday==="true",onCheckedChange:s=>{y("isPopularToday",s===!0?"true":"false")},className:"flex-shrink-0"})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 min-w-0",children:[e.jsx(u,{htmlFor:"isLatestUpdate",className:"text-sm font-medium truncate cursor-pointer",children:"Latest Updates"}),e.jsx(ie,{id:"isLatestUpdate",checked:g.isLatestUpdate==="true",onCheckedChange:s=>{y("isLatestUpdate",s===!0?"true":"false")},className:"flex-shrink-0"})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 min-w-0",children:[e.jsx(u,{htmlFor:"isPinned",className:"text-sm font-medium truncate cursor-pointer",children:"Pinned"}),e.jsx(ie,{id:"isPinned",checked:g.isPinned==="true",onCheckedChange:s=>{y("isPinned",s===!0?"true":"false")},className:"flex-shrink-0"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Select which homepage sections this series should appear in. You can select multiple sections."})]}),o&&e.jsxs("div",{className:"space-y-4 border-t pt-6 mt-6",children:[e.jsxs("div",{children:[e.jsx(u,{className:"text-sm font-medium",children:"Chapter Management"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Upload and manage chapters for this series. Upload chapters as ZIP files containing images."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"chapterNumber",className:"text-sm font-medium",children:"Chapter Number *"}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{id:"chapterNumber",type:"text",placeholder:"e.g. 1, 1.5, 2",value:Q,onChange:s=>Se(s.target.value),className:"bg-background/50 w-full pr-20",disabled:c}),P.length>0&&e.jsx(n,{type:"button",variant:"ghost",size:"sm",className:"absolute right-1 top-1 h-8 px-2 text-xs text-muted-foreground hover:text-foreground whitespace-nowrap",onClick:()=>{const s=P.map(x=>parseFloat(x.chapterNumber)||0),a=Math.max(...s);let i;a%1!==0?i=Math.ceil(a):i=a+1;const h=i.toString();s.includes(i)?r({title:"Chapter Number Conflict",description:`Chapter ${h} already exists. Please use a different number.`,variant:"destructive"}):(Se(h),r({title:"Chapter Number Suggested",description:`Set to Chapter ${h}`}))},disabled:c,title:"Suggest next chapter number based on existing chapters",children:Q?"Auto":`Next (${(()=>{const s=P.map(i=>parseFloat(i.chapterNumber)||0),a=Math.max(...s);return a%1!==0?Math.ceil(a):a+1})()})`})]})]}),e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"chapterTitle",className:"text-sm font-medium",children:"Chapter Title (optional)"}),e.jsx(T,{id:"chapterTitle",type:"text",placeholder:"e.g. The Beginning",value:Pe,onChange:s=>He(s.target.value),className:"bg-background/50 w-full",disabled:c})]})]}),e.jsxs("div",{className:`relative border-2 border-dashed rounded-lg transition-all duration-200 overflow-hidden ${ge?"border-primary bg-primary/10 scale-[1.02]":c?"border-primary bg-primary/5":"border-border hover:border-primary/50 hover:bg-background/30"}`,onDragOver:Js,onDragLeave:Ks,onDrop:Qs,children:[e.jsx("input",{ref:J,type:"file",accept:".zip",onChange:_s,className:"hidden",disabled:c}),c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute bottom-0 left-0 w-full bg-gradient-to-t from-primary/25 to-primary/15 transition-all duration-1000 ease-out",style:{height:xe?"60%":`${pe}%`,animation:xe?"liquid-wave 3s ease-in-out infinite":"none"}}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full bg-gradient-to-t from-primary/35 to-primary/25 transition-all duration-1000 ease-out",style:{height:xe?"40%":`${Math.max(0,pe-15)}%`,animation:xe?"liquid-wave 3s ease-in-out infinite 0.5s":"none"}}),e.jsx("style",{children:`
                    @keyframes liquid-wave {
                      0%, 100% { transform: translateY(0px); }
                      50% { transform: translateY(-8px); }
                    }
                  `})]}),e.jsxs("div",{className:"relative z-10 p-8 text-center space-y-4",children:[e.jsx("div",{className:`mx-auto w-16 h-16 rounded-full flex items-center justify-center transition-colors duration-200 ${ge?"bg-primary/20 text-primary":c?"bg-muted text-muted-foreground":"bg-muted/50 text-muted-foreground hover:bg-primary/10 hover:text-primary"}`,children:c?e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-primary border-t-transparent rounded-full"}):e.jsx(Ne,{className:"w-6 h-6"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:`font-medium ${ge||c?"text-primary":"text-foreground"}`,children:c?"Uploading Chapter...":ge?"Drop your ZIP file here":"Drag & Drop your ZIP file here"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c?xe?"Validating and processing...":`${w} (${pe}%)`:"or click to browse and select a ZIP file"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ZIP files should contain images named in order (001.jpg, 002.jpg, etc.) â€¢ Max ",Ee?.maxZipSizeMB||200,"MB"]})]}),!c&&e.jsxs(n,{type:"button",variant:"outline",onClick:()=>J.current?.click(),disabled:!Q.trim(),className:"bg-background/50 hover:bg-background/70",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Browse Files"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[e.jsxs(u,{className:"text-sm font-medium",children:["Chapters (",P.length,")"]}),P.length>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(n,{variant:"ghost",size:"sm",onClick:na,className:"text-xs",children:v.size===P.length?e.jsxs(e.Fragment,{children:[e.jsx(Ts,{className:"w-3 h-3 mr-1"}),e.jsx("span",{className:"hidden xs:inline",children:"Deselect All"}),e.jsx("span",{className:"xs:hidden",children:"Deselect"})]}):e.jsxs(e.Fragment,{children:[e.jsx(zs,{className:"w-3 h-3 mr-1"}),e.jsx("span",{className:"hidden xs:inline",children:"Select All"}),e.jsx("span",{className:"xs:hidden",children:"Select"})]})}),v.size>0&&e.jsxs(e.Fragment,{children:[e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>ws(!0),className:"text-xs",children:[e.jsx($e,{className:"w-3 h-3 mr-1"}),e.jsxs("span",{className:"hidden sm:inline",children:["Publish (",v.size,")"]}),e.jsx("span",{className:"sm:hidden",children:"Publish"})]}),e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>ws(!1),className:"text-xs",children:[e.jsx(Ma,{className:"w-3 h-3 mr-1"}),e.jsxs("span",{className:"hidden sm:inline",children:["Unpublish (",v.size,")"]}),e.jsx("span",{className:"sm:hidden",children:"Unpublish"})]}),e.jsxs(n,{variant:"destructive",size:"sm",onClick:()=>Fe(!0),className:"text-xs",children:[e.jsx(je,{className:"w-3 h-3 mr-1"}),e.jsxs("span",{className:"hidden sm:inline",children:["Delete (",v.size,")"]}),e.jsx("span",{className:"sm:hidden",children:"Delete"})]})]})]})]}),P.length===0?e.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-border/50 rounded-lg",children:[e.jsx(Xe,{className:"w-8 h-8 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No chapters uploaded yet. Upload a ZIP file to add chapters."}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"ZIP files should contain images named in order (001.jpg, 002.jpg, etc.)"})]}):e.jsx("div",{className:"space-y-2",children:P.sort((s,a)=>parseFloat(s.chapterNumber)-parseFloat(a.chapterNumber)).map((s,a)=>e.jsxs("div",{className:`group flex items-start sm:items-center bg-card/40 hover:bg-card/60 rounded-xl border border-border/30 p-2.5 sm:p-3 transition-all duration-200 hover:border-border/50 ${v.has(s.id)?"ring-2 ring-primary/40 bg-primary/8":""}`,children:[e.jsx("div",{className:"flex-shrink-0 mr-2 sm:mr-3",children:e.jsx(n,{variant:"ghost",size:"sm",className:"h-7 w-7 sm:h-8 sm:w-8 p-0 hover:bg-primary/10 rounded-lg",onClick:i=>{i.stopPropagation(),la(s.id)},children:v.has(s.id)?e.jsx(Ts,{className:"w-4 h-4 text-primary"}):e.jsx(zs,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsx("div",{className:"flex-shrink-0 mr-3 sm:mr-4 relative",children:e.jsx("div",{className:"w-10 h-14 sm:w-12 sm:h-16 bg-muted/40 rounded-lg overflow-hidden group-hover:bg-muted/60 transition-all duration-200 shadow-sm",children:s.coverImageUrl&&!Zs.has(s.id)?e.jsx("img",{src:s.coverImageUrl,alt:`Chapter ${s.chapterNumber} cover`,className:"w-full h-full object-cover max-w-full",onError:()=>ca(s.id),loading:"lazy"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Ms,{className:"w-5 h-5 text-muted-foreground/50"})})})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0 space-y-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("h3",{className:"font-semibold text-[11px] xs:text-sm sm:text-base leading-tight truncate",children:["Chapter ",s.chapterNumber]}),e.jsx("div",{className:`text-[9px] xs:text-xs sm:text-sm px-1.5 xs:px-2 py-0.5 rounded-full font-medium flex-shrink-0 ${s.isPublished==="true"?"bg-green-500 text-white":"bg-gray-500 text-white"}`,children:s.isPublished==="true"?"Published":"Draft"})]}),e.jsx("p",{className:"text-[10px] xs:text-xs sm:text-sm text-muted-foreground truncate leading-tight",title:s.title,children:s.title||"No title"}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 text-[10px] xs:text-xs sm:text-sm text-muted-foreground flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Xe,{className:"w-3 h-3 flex-shrink-0"}),e.jsxs("span",{className:"whitespace-nowrap",children:[s.totalPages," pages"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(La,{className:"w-3 h-3 flex-shrink-0"}),e.jsx("span",{className:"truncate max-w-[120px] sm:max-w-none sm:whitespace-nowrap",children:Ns(s.createdAt)})]})]})]}),e.jsxs("div",{className:"flex gap-1 sm:gap-1.5 flex-shrink-0",children:[e.jsxs("div",{className:"flex gap-1 md:hidden",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>js(s),className:"h-8 w-8 p-0 hover:bg-primary/10",title:"Edit chapter",children:e.jsx(Re,{className:"w-3 h-3"})}),e.jsx(n,{variant:"outline",size:"sm",className:"text-destructive hover:text-destructive hover:bg-destructive/10 h-8 w-8 p-0",onClick:()=>m(s.id),title:"Delete chapter",children:e.jsx(je,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"hidden md:flex gap-1.5",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>ha(s),className:"h-9 w-9 lg:h-10 lg:w-10 p-0 hover:bg-primary/10",title:"Preview chapter pages",children:e.jsx($e,{className:"w-3.5 h-3.5 lg:w-4 lg:h-4"})}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>js(s),className:"h-9 w-9 lg:h-10 lg:w-10 p-0 hover:bg-primary/10",title:"Edit chapter details",children:e.jsx(Re,{className:"w-3.5 h-3.5 lg:w-4 lg:h-4"})}),e.jsx(n,{variant:"outline",size:"sm",onClick:i=>{i.stopPropagation(),da(s)},className:"h-9 w-9 lg:h-10 lg:w-10 p-0 hover:bg-primary/10",title:"Change cover image",children:e.jsx(As,{className:"w-3.5 h-3.5 lg:w-4 lg:h-4"})}),e.jsx(n,{variant:"outline",size:"sm",className:"text-destructive hover:text-destructive hover:bg-destructive/10 h-9 w-9 lg:h-10 lg:w-10 p-0",onClick:()=>m(s.id),title:"Delete chapter",children:e.jsx(je,{className:"w-3.5 h-3.5 lg:w-4 lg:h-4"})})]})]})]})})]},s.id))})]})]})]}),[g,o,P,c,w,f,X,ae,Q,Pe,ge,v]),ja=e.jsx(H,{open:Hs,onOpenChange:Ue,children:e.jsxs(W,{className:"sm:max-w-md",children:[e.jsxs(Z,{children:[e.jsxs(Y,{children:["Edit Chapter ",B?.chapterNumber]}),e.jsx(le,{children:"Update chapter metadata and publication status"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"editTitle",children:"Chapter Title (optional)"}),e.jsx(T,{id:"editTitle",value:B?.title||"",onChange:s=>De(a=>({...a,title:s.target.value})),placeholder:"Enter chapter title",className:"bg-background/50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Publication Status"}),e.jsxs(Ke,{value:B?.isPublished||"true",onValueChange:s=>De(a=>({...a,isPublished:s})),children:[e.jsx(Qe,{className:"bg-background/50",children:e.jsx(_e,{})}),e.jsxs(es,{children:[e.jsx(Le,{value:"true",children:"Published"}),e.jsx(Le,{value:"false",children:"Draft"})]})]})]}),e.jsxs("div",{className:"pt-2 space-y-1 text-xs text-muted-foreground",children:[e.jsxs("p",{children:["Pages: ",B?.totalPages]}),e.jsxs("p",{children:["Uploaded: ",Ns(B?.createdAt)]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsxs(n,{variant:"outline",onClick:()=>Ue(!1),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(n,{onClick:ia,children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Update Chapter"]})]})]})}),wa=e.jsx(H,{open:!!Te,onOpenChange:()=>{ze(null),oe(null),O.current&&(O.current.value="")},children:e.jsxs(W,{className:"sm:max-w-md",children:[e.jsxs(Z,{children:[e.jsx(Y,{children:"Edit Chapter Cover"}),e.jsxs(le,{children:["Update the cover image for Chapter ",Te?.chapterNumber]})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Cover Preview"}),e.jsx("div",{className:"relative aspect-[3/4] max-w-48 mx-auto rounded-lg overflow-hidden bg-muted/50 border",children:de?e.jsx("img",{src:de,alt:"Cover preview",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Ms,{className:"w-12 h-12 text-muted-foreground/50"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"chapterCoverFile",children:"Upload New Cover"}),e.jsx(T,{id:"chapterCoverFile",type:"file",ref:O,accept:"image/*",onChange:oa,className:"bg-background/50"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Supported formats: JPG, PNG, WebP. Max size: 5MB"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"chapterCoverUrl",children:"Or Enter Image URL"}),e.jsx(T,{id:"chapterCoverUrl",type:"url",placeholder:"https://example.com/cover.jpg",value:de||"",onChange:s=>oe(s.target.value),className:"bg-background/50"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsxs(n,{variant:"outline",onClick:()=>{ze(null),oe(null),O.current&&(O.current.value="")},children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsx(n,{onClick:ma,disabled:ps,children:ps?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 mr-2 animate-spin rounded-full border-2 border-current border-t-transparent"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Update Cover"]})})]})]})});return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-background/95 p-2 sm:p-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-2 sm:px-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 sm:justify-between mb-6 sm:mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[e.jsx(ba,{href:"/admin",children:e.jsxs(n,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-primary",children:[e.jsx(Da,{className:"w-4 h-4 mr-2"}),"Back to Admin Panel"]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xe,{className:"w-8 h-8 text-primary"}),e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold bg-gradient-to-r from-primary via-accent to-purple-400 bg-clip-text text-transparent",children:"Content Management"})]})]}),e.jsxs(H,{open:d,onOpenChange:s=>{F(s),s||me()},children:[e.jsx(ss,{asChild:!0,children:e.jsxs(n,{className:"bg-gradient-to-r from-primary to-accent hover:from-primary/90 hover:to-accent/90",children:[e.jsx(Ra,{className:"w-4 h-4 mr-2"}),"Add Series"]})}),e.jsxs(W,{className:"flex flex-col w-[95vw] sm:w-[70vw] max-w-none max-h-[90vh] sm:max-h-[85vh] overflow-hidden",children:[e.jsxs(Z,{className:"flex-shrink-0",children:[e.jsx(Y,{children:"Add New Series"}),e.jsx(le,{children:"Add a new manga/manhwa series to the collection."})]}),e.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden px-1 sm:px-2",children:Ye}),e.jsxs("div",{className:"flex justify-end space-x-2 flex-shrink-0 pt-4 border-t",children:[e.jsxs(n,{variant:"outline",onClick:()=>{F(!1),me()},children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(n,{onClick:xa,children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Add Series"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx(Ge,{className:"bg-card/80 backdrop-blur-md border-border/50",children:e.jsx(Je,{className:"p-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ua,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(T,{placeholder:"Search series by title, author, type, or genre...",value:M,onChange:s=>N(s.target.value),className:"pl-10 bg-background/50"})]})})})}),e.jsx(Ge,{className:"bg-card/80 backdrop-blur-md border-border/50",children:e.jsx(Je,{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:A.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Series"})]})})})]}),e.jsxs(Ge,{className:"bg-card/80 backdrop-blur-md border-border/50",children:[e.jsxs(Fa,{children:[e.jsx(Ea,{children:"All Series"}),e.jsx(Ta,{children:"Manage manga and manhwa series in the collection"})]}),e.jsx(Je,{children:l?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading series..."})}):ks.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:M?"No series found matching your search.":"No series found."})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:ks.map(s=>e.jsxs("div",{className:"group relative bg-card/80 backdrop-blur-sm rounded-xl border border-border/40 overflow-hidden hover:shadow-xl hover:shadow-primary/10 transition-all duration-300 hover:border-primary/30 hover:scale-[1.02]",children:[e.jsxs("div",{className:"relative aspect-[3/4] overflow-hidden bg-muted",children:[s.coverImageUrl?e.jsx("img",{src:s.coverImageUrl,alt:s.title,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-muted to-muted/60",children:e.jsx(As,{className:"w-8 h-8 text-muted-foreground/50"})}),e.jsx("div",{className:"absolute top-2 left-2",children:va(s.status)}),s.isAdult==="true"&&e.jsx(se,{variant:"destructive",className:"absolute top-2 right-2 text-xs",children:"18+"}),s.rating&&e.jsxs("div",{className:"absolute bottom-2 right-2 flex items-center space-x-1 bg-black/70 backdrop-blur-sm rounded-md px-2 py-1",children:[e.jsx(za,{className:"w-3 h-3 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"text-white text-xs font-medium",children:s.rating})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsx("div",{className:"absolute inset-x-2 bottom-2 opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-2 group-hover:translate-y-0 space-y-2",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(H,{children:[e.jsx(ss,{asChild:!0,children:e.jsxs(n,{size:"sm",variant:"secondary",className:"flex-1 bg-background/90 hover:bg-background text-xs min-h-[44px] h-auto px-3 py-2",onClick:()=>ys(s),children:[e.jsx(Re,{className:"w-3 h-3 mr-1"}),"Edit"]})}),e.jsxs(W,{className:"flex flex-col w-[95vw] sm:w-[70vw] max-w-none max-h-[90vh] sm:max-h-[85vh] overflow-hidden",children:[e.jsxs(Z,{className:"flex-shrink-0",children:[e.jsx(Y,{children:"Edit Series"}),e.jsx(le,{children:"Update series information and metadata."})]}),e.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden px-1 sm:px-2",children:Ye}),e.jsxs("div",{className:"flex justify-end space-x-2 flex-shrink-0 pt-4 border-t",children:[e.jsxs(n,{variant:"outline",onClick:()=>{z(null),me()},children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(n,{onClick:Cs,children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]})]}),e.jsx(n,{size:"sm",variant:"destructive",className:"text-xs px-2",onClick:()=>I(s.id),children:e.jsx(je,{className:"w-3 h-3"})})]})})]}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm line-clamp-2 leading-tight",title:s.title,children:s.title}),s.author&&e.jsxs("p",{className:"text-xs text-muted-foreground truncate mt-1",children:["by ",s.author]})]}),e.jsxs("div",{className:"flex md:hidden items-center space-x-2 ml-2 flex-shrink-0",children:[e.jsxs(H,{children:[e.jsx(ss,{asChild:!0,children:e.jsx(n,{variant:"ghost",size:"sm",className:"h-11 w-11 p-0 min-h-[44px]",onClick:()=>ys(s),children:e.jsx(Re,{className:"w-4 h-4"})})}),e.jsxs(W,{className:"flex flex-col w-[95vw] sm:w-[70vw] max-w-none max-h-[90vh] sm:max-h-[85vh] overflow-hidden",children:[e.jsxs(Z,{className:"flex-shrink-0",children:[e.jsx(Y,{children:"Edit Series"}),e.jsx(le,{children:"Update series information and metadata."})]}),e.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden px-1 sm:px-2",children:Ye}),e.jsxs("div",{className:"flex justify-end space-x-2 flex-shrink-0 pt-4 border-t",children:[e.jsxs(n,{variant:"outline",onClick:()=>{z(null),me()},children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(n,{onClick:Cs,children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]})]}),e.jsx(n,{variant:"ghost",size:"sm",className:"h-11 w-11 p-0 min-h-[44px] text-destructive hover:text-destructive",onClick:()=>I(s.id),children:e.jsx(je,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:e.jsx(se,{variant:"outline",className:"text-xs",children:s.type})}),Array.isArray(s.genres)&&s.genres.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.genres.slice(0,2).map(a=>e.jsx(se,{variant:"secondary",className:"text-xs px-1 py-0",children:a},a)),s.genres.length>2&&e.jsxs(se,{variant:"secondary",className:"text-xs px-1 py-0",children:["+",s.genres.length-2]})]})]})]},s.id))})})]}),e.jsx(as,{open:!!E,onOpenChange:()=>I(null),children:e.jsxs(ts,{children:[e.jsxs(rs,{children:[e.jsx(is,{children:"Delete Series"}),e.jsx(ls,{children:"Are you sure you want to delete this series? This action cannot be undone and will permanently remove all series data, chapters, and images."})]}),e.jsxs(ns,{children:[e.jsx(cs,{children:"Cancel"}),e.jsx(ds,{onClick:()=>E&&ga(E),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete Series"})]})]})}),e.jsx(as,{open:!!q,onOpenChange:()=>m(null),children:e.jsxs(ts,{children:[e.jsxs(rs,{children:[e.jsx(is,{children:"Delete Chapter"}),e.jsx(ls,{children:"Are you sure you want to delete this chapter? This action cannot be undone and will permanently remove all chapter data and images."})]}),e.jsxs(ns,{children:[e.jsx(cs,{children:"Cancel"}),e.jsx(ds,{onClick:()=>{q&&(ra(q),m(null))},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete Chapter"})]})]})}),ja,wa,e.jsx(as,{open:Ws,onOpenChange:Fe,children:e.jsxs(ts,{children:[e.jsxs(rs,{children:[e.jsxs(is,{children:["Delete ",v.size," Chapters"]}),e.jsxs(ls,{children:["Are you sure you want to delete ",v.size," selected chapters? This action cannot be undone and will permanently remove all chapter data and images."]})]}),e.jsxs(ns,{children:[e.jsx(cs,{children:"Cancel"}),e.jsxs(ds,{onClick:ua,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:["Delete ",v.size," Chapters"]})]})]})}),e.jsx(H,{open:Is,onOpenChange:ke,children:e.jsxs(W,{className:"sm:max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs(Z,{className:"flex-shrink-0",children:[e.jsxs(Y,{children:["Preview: Chapter ",K?.chapterNumber,K?.title&&` - ${K.title}`]}),e.jsxs(le,{children:["Preview of the first few pages. ",K?.totalPages||0," total pages."]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:Os?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),e.jsx("span",{className:"ml-3 text-muted-foreground",children:"Loading preview..."})]}):ms.length>0?e.jsxs("div",{className:"space-y-4",children:[ms.map((s,a)=>e.jsxs("div",{className:"border rounded-lg overflow-hidden bg-muted/30",children:[e.jsxs("div",{className:"p-2 bg-muted/50 text-sm font-medium",children:["Page ",a+1]}),e.jsx("div",{className:"flex justify-center p-4",children:e.jsx("img",{src:s,alt:`Page ${a+1}`,className:"max-w-full max-h-96 object-contain rounded border",loading:"lazy",onError:i=>{i.target.src="/placeholder-image.png"}})})]},a)),K?.totalPages>5&&e.jsxs("div",{className:"text-center py-4 text-muted-foreground",children:["... and ",K.totalPages-5," more pages"]})]}):e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"No preview available for this chapter."})}),e.jsxs("div",{className:"flex justify-end space-x-2 flex-shrink-0 pt-4 border-t",children:[e.jsxs(n,{variant:"outline",onClick:()=>ke(!1),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Close"]}),K&&e.jsxs(n,{onClick:()=>{window.open(`/manga/${o?.id}/chapter/${K.chapterNumber}`,"_blank")},children:[e.jsx($e,{className:"w-4 h-4 mr-2"}),"View Full Chapter"]})]})]})}),L&&e.jsx(Oa,{isOpen:Ys,onClose:ta,onConfirm:ea,initialPages:L.pages,chapterNumber:L.chapter.chapterNumber,chapterTitle:L.chapter.title,naturalSortConfidence:L.naturalSortConfidence,requiresManualReorder:L.requiresManualReorder}),e.jsx(Ha,{open:Rs,onOpenChange:Ce,uploadId:$s,onComplete:sa,onError:aa})]})})}export{ot as default};
