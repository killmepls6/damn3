import{j as e}from"./ui-vendor-BpIggZZ9.js";import{u as k,b as A}from"./react-vendor-C7VPsBAG.js";import{c as P,u as E,P as F,b as L,d as b,N as u,a0 as j,C as n,B as r,f as x,g as h,h as q,p as R,i as g,W as T,a1 as y,a7 as M,aa as B,F as X,r as N}from"./index-Bshoxa3b.js";import{A as Y,a as H,b as K,c as O,d as Q,e as U,f as W,g as I}from"./alert-dialog-ckVHmtNn.js";import{C as v}from"./crown-DnGdiNOO.js";import{C as V}from"./calendar-ByILsbL3.js";import"./utils-vendor-BUCX3MvZ.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=P("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);function te(){const[,c]=k(),{isAuthenticated:f,isLoading:w}=E(),{toast:i}=F(),[C,l]=A.useState(!1),{data:a,isLoading:S}=L({queryKey:["/api/subscriptions/current"],queryFn:async()=>{const s=await fetch("/api/subscriptions/current",{credentials:"include"});if(s.status===404)return null;if(!s.ok)throw new Error("Failed to fetch subscription");return s.json()},enabled:f}),o=b({mutationFn:async()=>{const s=await fetch("/api/subscriptions/cancel",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"include"});if(!s.ok){const t=await s.json();throw new Error(t.message||"Failed to cancel subscription")}return s.json()},onSuccess:()=>{N.invalidateQueries({queryKey:["/api/subscriptions/current"]}),i({title:"Subscription Cancelled",description:"Your subscription will remain active until the end of the billing period."}),l(!1)},onError:s=>{i({title:"Error",description:s.message,variant:"destructive"})}}),d=b({mutationFn:async()=>{const s=await fetch("/api/subscriptions/reactivate",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"include"});if(!s.ok){const t=await s.json();throw new Error(t.message||"Failed to reactivate subscription")}return s.json()},onSuccess:()=>{N.invalidateQueries({queryKey:["/api/subscriptions/current"]}),i({title:"Subscription Reactivated",description:"Your subscription will continue automatically."})},onError:s=>{i({title:"Error",description:s.message,variant:"destructive"})}});if(w||S)return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[e.jsx(u,{}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-20",children:[e.jsx(j,{className:"h-12 w-96 mx-auto mb-12 bg-gray-800"}),e.jsx(j,{className:"h-96 bg-gray-800"})]})]});if(!a)return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[e.jsx(u,{}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-20",children:e.jsxs(n,{className:"bg-gray-900/50 border-gray-800 text-center p-12",children:[e.jsx(v,{className:"w-16 h-16 mx-auto mb-4 text-gray-600"}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"No Active Subscription"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Subscribe to a plan to unlock premium features"}),e.jsx(r,{onClick:()=>c("/subscriptions"),className:"bg-gradient-to-r from-primary to-accent hover:from-primary/90 hover:to-accent/90",children:"View Plans"})]})})]});const D=(s=>{try{return JSON.parse(s)}catch{return[]}})(a.features),p=a.status==="active",m=a.cancelAtPeriodEnd==="true";return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[e.jsx(u,{}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-16",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx(r,{variant:"ghost",onClick:()=>c("/subscriptions"),className:"text-gray-400 hover:text-white mb-4",children:"â† Back to Plans"}),e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Manage Subscription"}),e.jsx("p",{className:"text-gray-400",children:"View and manage your subscription details"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(n,{className:"bg-gray-900/50 border-gray-800",children:[e.jsx(x,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(h,{className:"text-white flex items-center gap-2",children:[e.jsx(v,{className:"w-5 h-5 text-primary"}),a.packageName]}),e.jsxs(q,{children:["$",a.priceUSD,"/month"]})]}),e.jsx(R,{variant:p?"default":"secondary",className:p?"bg-green-500/20 text-green-500 border-green-500/30":"",children:a.status})]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(V,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Current Period"}),e.jsxs("p",{className:"text-white font-medium",children:[new Date(a.currentPeriodStart).toLocaleDateString()," - ",new Date(a.currentPeriodEnd).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(z,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Next Billing"}),e.jsx("p",{className:"text-white font-medium",children:m?"N/A (Cancelled)":new Date(a.currentPeriodEnd).toLocaleDateString()})]})]})]}),m&&e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(T,{className:"w-5 h-5 text-amber-500 shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-amber-500 font-medium",children:"Subscription Ending"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Your subscription will end on ",new Date(a.currentPeriodEnd).toLocaleDateString(),". Reactivate to continue enjoying premium benefits."]})]})]})]})]}),e.jsxs(n,{className:"bg-gray-900/50 border-gray-800",children:[e.jsx(x,{children:e.jsx(h,{className:"text-white",children:"Features Included"})}),e.jsx(g,{children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:D.map((s,t)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(y,{className:"w-5 h-5 text-primary shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm text-gray-300",children:s})]},t))})})]}),e.jsxs(n,{className:"bg-gray-900/50 border-gray-800",children:[e.jsx(x,{children:e.jsx(h,{className:"text-white",children:"Subscription Actions"})}),e.jsxs(g,{className:"space-y-3",children:[e.jsxs(r,{onClick:()=>c("/subscriptions"),variant:"outline",className:"w-full justify-start border-gray-700 hover:bg-gray-800",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Upgrade Plan"]}),m?e.jsxs(r,{onClick:()=>d.mutate(),disabled:d.isPending,variant:"outline",className:"w-full justify-start border-green-500/30 text-green-500 hover:bg-green-500/10",children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),d.isPending?"Reactivating...":"Reactivate Subscription"]}):e.jsxs(r,{onClick:()=>l(!0),variant:"outline",className:"w-full justify-start border-red-500/30 text-red-500 hover:bg-red-500/10",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Cancel Subscription"]})]})]})]})]}),e.jsx(Y,{open:C,onOpenChange:l,children:e.jsxs(H,{className:"bg-gray-900 border-gray-800",children:[e.jsxs(K,{children:[e.jsx(O,{className:"text-white",children:"Cancel Subscription?"}),e.jsxs(Q,{className:"text-gray-400",children:["Your subscription will remain active until the end of the current billing period on ",new Date(a.currentPeriodEnd).toLocaleDateString(),". You can reactivate anytime before then."]})]}),e.jsxs(U,{children:[e.jsx(W,{className:"bg-gray-800 border-gray-700 text-white hover:bg-gray-700",children:"Keep Subscription"}),e.jsx(I,{onClick:()=>o.mutate(),disabled:o.isPending,className:"bg-red-500 hover:bg-red-600",children:o.isPending?"Cancelling...":"Cancel Subscription"})]})]})}),e.jsx(X,{})]})}export{te as default};
